{{$NEXT}}

1.104     2015-10-02 14:52:24+02:00 Europe/Berlin

 - An ACL line that permits ESP or AH (protocol 50 or 51)
   is no longer moved inside an existing ACL.
   A new ACL is created instead.
   This is done to prevent accidental lock out from device,
   if the device is accessed via an ESP/AH tunnel.
 - Twice NAT command of ASA >= 8.4 isn't touched by approve any longer.
   Twice NAT and the corresponding "network object" commands
   have to be configured manually now.

1.103     2015-09-22 16:54:12+02:00 Europe/Berlin

 - No longer show annoying 'PROCESS/Change' messages when approving
   Cisco firewall.
 - Prepare for upcoming change of Netspoc to two pass compiler:
   - Ignore any file with extension in pxx/code, not only *.raw files.
   - newpolicy.pl 
     - adds symlink pxx+1/code/.prev pointing to pxx/code
     - removes pxx/code/*.{config,rules} after pxx+1/code has successfully
       been generated.

1.102     2015-07-22 17:06:42+02:00 Europe/Berlin

 - Added port names msrpc, ripv6, connectedapps-plain, connectedapps-tls
   for Cisco ISR-4321 router.

1.101     2015-07-22 09:56:51+02:00 Europe/Berlin

 - Fix: Enter conf mode before removing crypto filter ACL.

1.100     2015-07-20 16:28:08+02:00 Europe/Berlin

 - Fixed bug where tunnel-group with IP address occosionally was
   tried to define twice. 
   This occured if a corresponding tunnel-group-map was added.

1.099     2015-06-29 11:40:47+02:00 Europe/Berlin

 - Crypto commands for IOS are assumed to be configured mostly manually now.
   This allows to process devices with IKEv2 configuration.
   - Existence is checked for
     - 'crypto map ipsec-isakmp' and 
     - 'crypto ipsec client'.
   - Filter ACLs of crypto maps are compared and updated.
   - All other crypto commands and their sub commands are ignored and 
     left unchanged.

1.098     2015-06-18 15:34:19+02:00 Europe/Berlin

 - Fixed processing of tunnel-group-map referencing tunnel-group with IP.

1.097     2015-06-09 14:49:17+02:00 Europe/Berlin

 - Added support for dynamic crypto map.
   - Name must be unique, e.g. certificate name.
   - Only a single sequence number can be used per dynamic-map.
 - Added support for ikev2 ipsec-proposal.
 - Automatically add and remove transform-sets.
 - Ignore pre-shared key in crypto map. Must be set manually.
 - Split logfile from 'Expect' (*.tel) into 3 separate files
   *.login, *.config, *.change.
 - Move existing logfile from Expect before writing new one.

1.096     2015-01-22 10:59:03+01:00 Europe/Berlin

 - Approve won't check interfaces if generated config 
   contains no interfaces at all. This occurs for device with 
   "managed=routing_only".
 - Added support of 'remark' lines in ACLs of Cisco IOS.

1.095     2014-11-26 18:17:44+01:00 Europe/Berlin

 - Fixed warning, when reading empty status file.

1.094     2014-11-26 17:51:59+01:00 Europe/Berlin

 - Added support for named TCP port 'ctiqbe' = 2748 for cisco devices.

1.093     2014-11-21 11:18:23+01:00 Europe/Berlin

 - Added workaround for bug #100342 in Expect.pm when parsing ouput of
   Linux commands.
 - Added new config option "keep_history". 
   This option determines, after how many days old history files are removed.
   The value must be >= 30. Default value is 365.
 - Script "delete-old-policies" now also removes old files 
   in "historydir" and "statusdir".

1.092     2014-06-26 14:32:25 Europe/Berlin

 - Fixed approve for ASA: Only warn on spare ACL that was
   generated by netspoc.
 - Fixed handling of reload banner by fixing parsing of Cisco prompt.

1.091     2014-06-23 10:16:24 Europe/Berlin

 - Fixed approve for NX-OS again. 
   Ignore valid output of 'verify' command.

1.090     2014-06-16 14:02:18 Europe/Berlin

 - Fixed approve for NX-OS.  If 'verify' of configuration session
   fails, the 'abort' command is called now.
 - Fixed 'newpolicy' to recognize removed file.
 
1.089     2014-05-20 10:21:48 Europe/Berlin

 - Ignore escape sequence following the prompt, when login to Linux device.

1.088     2014-05-19 18:22:47 Europe/Berlin

 - Fixed call to "cvs" in newpolicy: 
   Must use relative pathname in server mode.

1.087     2014-05-19 17:32:22 Europe/Berlin

 - The command 'newpolicy' copies the newest version of netspoc files
   from repository to a dedicated directory. From there the generated
   code is deployed to devices.
  
   Until now, only a single user was allowed to invoke 'newpolicy'.
   Others had to wait until the commd had finished. This was annoying
   if code generation from a large configuration needed some time.

   Now, 'newpolicy' can be invoked by multiple users in parallel.
   First it checks, if there are any changes to the repository.
   - If there are no changes, it exits.
   - Otherwise it checks if these changes are already processes by some
     running instance. Then ist shows the output of that instance.
   - If new changes are pending, it first waits for a running instance 
     to terminate. After that, a new instance is started 
     to process the pending changes.

   'newpolicy' now calls a C-wrapper that in turn calls 'newpolicy.pl'.
   The C-wrapper has been renamed from 'newpolicy' to 'suid-newpolicy'.

   Existing installations should move 'newpolicy' to 'suid-newpolicy'
   before installing this release.

 - 'newpolicy.pl' no longer checks if the 'netspoc' directory of the
   calling user is up-to-date. Only the repository is checked now.

 - 'newpolicy.pl' exits with status code '2', if another instance is 
   already running. It no longer prints a message in this case.

 - Minor fixes to suid-newpolicy. 

1.086     2014-04-14 15:13:58 Europe/Berlin

 - New config options in /etc/netspoc-approve:
   - timeout: Timeout during session. Default: 60s
   - login_timeout: Timout when establishing session. Default: 3s
   - try_telnet: Try telnet if device isn't reachable by ssh. (Default: unset)
 - Removed option '-t' of command drc3.pl (default was 500s).

1.085     2014-04-11 12:03:25 Europe/Berlin

 - Ping command isn't used any longer to perform reachability check.
   A shorter timeout of 5s ist used now to prevent long wait at initial
   connection.
   This allows us to use the OpenSSH "ProxyCommand" for SSH connections.

1.084     2014-02-10 17:27:23 Europe/Berlin

 - Fixed login to Linux devices.
   No longer misinterpret '#' in banner as prompt.

1.083     2014-02-06 11:47:36 Europe/Berlin

 - Second and third transform name is optional now
   in command 'crypto ipsec transform-set' of IOS.
 - Added support for "remark" in ACL of NX-OS.
 - Added option '-u <username>' to drc3.pl to set the username for 
   logon to remote device.
 - Fixed command 'missing-approve' to no longer print duplicate router
   names if both, netspoc file and raw file have changed.

1.082     2014-01-08 11:45:36 Europe/Berlin

 - Added support for attributes 'dns' and 'unidirectional' in twice NAT.
 - Unnumbered interface with name 'mpls' from Netspoc is silently ignored,
   if device has some interface with 'ip mpls'.

1.081     2013-12-10 12:00:17 Europe/Berlin

 - Added support for 'destination static' in twice NAT of ASA 8.4.
 
1.080     2013-10-29 16:08:25 Europe/Berlin

 - Added support for keyword [APPEND] in raw files.
   This changes the behaviour of ACLs defined after this keyword.
   The ACL is no longer prepended, but it is appended to a Netspoc 
   generated ACL. It is appended at the end of an ACL, 
   but before the trailing "deny any any" entry from Netspoc.

 - Fixed missing-approve: If last compare found diff and if it occured
   later than last approve, then show missing-approve.
   
1.079     2013-08-23 14:07:33 Europe/Berlin

 - Urgent bug fix: Startup config with static routes for linux
   is written correctly again. Was broken since version 1.066.
 - Domain-name is ignored now when comparing
   name of device and router name from netspoc.
 - Secondary ip address of NX-OS can be parsed now but is still ignored.

1.078     2013-08-14 16:21:51 Europe/Berlin

 - Command "approve-all" no longer operates on all devices
   but only on devices shown by missing-approve.
 - Command "missing-approve" checks for newer compare status 
   even if last approve failed.

1.077     2013-07-02 16:05:18 Europe/Berlin

 - Added protocol name 'icmp6' => 58 for Cisco devices.
 - New format for aaa_credentials file
   - multiple lines
   - three fields, separated by whitespace: pattern username password
   - If current device name matches pattern, then return username and password.
   - Pattern may contain shell wildcard characters
     * matches zero or more characters
     ? matches one character
   - First matching line is taken.
   Old format is still supported
   - Only a single line with two fields: "username password"
   - is equivalent to "* username password"

1.076     2013-06-20 16:11:19 Europe/Berlin

 - Bug fix: Again read hostname from prompt for PIX.

1.075     2013-06-20 14:30:54 Europe/Berlin

 - Bug fix: Again read hostname from prompt for IOS.

1.074     2013-06-20 12:51:38 Europe/Berlin

 - No longer abort on 'names' command.
   Instead the 'name' command must not be used.
 - Support keyword 'any4' in ACL (for ASA 9.x).
 - Support keyword 'destination' in service-object of ASA.
 - Support 'remark' in ACL.
 - Handle ACL lines that only differ in 'log' keyword.
 - Ignore time-range when parsing ACL.
 - Use 'show hostname' and no longer the prompt 
   to get hostname of Cisco device.
 - Command "newpolicy" now ignores files matching '.#*' in working copy.

1.073     2013-05-14 17:43:57 Europe/Berlin

 - Ignore subcommand of "crypto ipsec transform-set"
   e.g. "mode tunnel" or "mode transport".
 - An ACL or object-group which is unrelated to ACLs generated by Netspoc
   isn't removed any longer on ASA and PIX.
   (This is already the default for IOS and NX-OS.)
   
1.072     2013-04-24 17:28:55 Europe/Berlin

 - Parallel jobs started by commands 'approve-all' and 'compare-all':
   - New optional parameter to change the number of jobs: 
     approve-all [parallel-count]
   - Default value has been increased from 10 to 40
 - New config file option "newpolicy_hooks".
   The value is a list of paths to be called 
   after successful run of newpolicy.
 - Added newpolicy.pl from Netspoc project.
 - Added scripts "compress-policies" and "delete-old-policies" 
   to be called from cron.
 - Changed all hard coded paths for netspocdir to be read
   from config file (/usr/local)/etc/netspoc-approve
 - New commandline tool 'get-netspoc-approve-conf' to read option 
   from config file.

1.071     2013-03-27 14:42:57 Europe/Berlin

- Fixed bug when comparing crypto ACLs and crypto filter ACLs.
  Result was unreliable, because inverted masks from IOS had been used.
- Fallback to username / password if only password was given for telnet.
- Better error messages if telnet or ssh failed.

1.070     2013-03-25 14:10:33 Europe/Berlin

- Support named loglevel in ACL of ASA/PIX

1.069     2013-03-12 14:51:45 Europe/Berlin

- New command "approve-all"
  Approves all devices shown by missing-approve.
  "diamonds approve" is called with new option --brief
   - message "Reachability test failed" is suppressed
   - final "FAILED" message is suppressed
   - error and warning messages get prefix "device-name:"
- Ignore subcommands of "crypto map ipv6" as well.

1.068     2013-03-07 17:34:18 Europe/Berlin

Bug fix realease

- Fixed ACL approve for IOS.
  Some IOS commands need to be called with "do" prefix,
  because conf mode is entered earlier since support for NX-OS was added.

1.067     2013-03-06 15:50:23 Europe/Berlin

- Ignore that VRFs of a device which are not found 
  in the config file from Netspoc.
  This allows to have mixed managed and unmanaged VRFs on the same device.
- Ignore "crypto map ipv6" when parsing IOS config.

1.066     2013-02-19 14:29:54 Europe/Berlin

- Added support for NX-OS of Cisco Nexus devices.
  - ACL, object-groups, routing, VRF
  - Uses "configure session"
  - Interface mgmt0 is located in management VRF by default
- Added support for object-groups of IOS.
- No longer re-read config of IOS after "write mem".
  It is sufficient to check the '[OK]' message.
- missing-approve now compares .raw files if available.
- Code cleanup.

1.065     2012-12-05 17:11:54 Europe/Berlin

- Fixed bug when generating object-group name in ACL.
  There was a bug,
  - when transferring an ACL
  - which references two object-groups,
  - where both object-groups are already available on device
  - and the netspoc name of dst object is identical to 
    the device name of the src object.
  In this case a wrong ACL was transferred: src and dst were swapped.

1.064     2012-12-04 14:17:15 Europe/Berlin

- Bugfix: Don't enter configuration mode when comparing.

1.063     2012-11-30 13:50:07 Europe/Berlin

- Bugfix: Standard ACL can't be changed incrementally on ASA

1.062     2012-11-29 17:14:56 Europe/Berlin

- Fixed missing device initialization for IOS,
  logging synchronous, etc.

1.061     2012-11-29 10:51:47 Europe/Berlin

- ACLs are changed incrementally for ASA and PIX now.
  Added test cases especially for ACL with object-group.
- Parser aborts now on unknown command in raw file.
- Simplified merging of route and static commands from raw file.
  Entries are simply prepended to Netspoc data now.
- Added test cases for merging raw files.
- Fixed bug in handling outgoing crypto filter ACL.
- Check for extra tables from Netspoc when comparing Linux.
- No longer issue "no fixup protocol smtp 25" when confuguring PIX.

1.060     2012-11-12 12:36:47 Europe/Berlin

- No longer compare running with startup config
  This doesn't matter, because we check the result of "write mem" anyway.

1.059     2012-09-20 13:13:54 Europe/Berlin

- Change interpreter back to perl (was env perl)

1.058     2012-09-19 17:29:57 Europe/Berlin

- Clean %ENV for taint mode.

1.057     2012-09-17 10:33:35 Europe/Berlin

- ASA: Support interface with ip address pppoe|dhcp
- Check for unsupported tunnel-group <ip> general-attributes
- Changed names in configuration file to lower case.
- Added SUID support script "diamonds".

1.056     2012-09-12 09:10:36 Europe/Berlin

- Fixed console logging directory

1.055     2012-09-11 17:50:38 Europe/Berlin

- Added 'vrf forwarding' as equivalent to 'ip vrf forwarding'
- Reading of password file has been generalized
  Simple name,password tuples are allowed now 
  in addition to cisco works format.
- Configuration file is read from 
  /etc/netspoc-approve
  /usr/local/etc/netspoc-approve 
  ~/.netspoc-approve
- Added support of object-group service, protocol for ASA
- No longer compare 'crypto isakmp identity' for IOS
- Removed rex3

1.054     2012-03-07 15:39:45 Europe/Berlin

- Command 'compare-all' no longer uses raw files.

1.053     2012-03-07 11:34:03 Europe/Berlin

- Command 'missing-approve' no longer shows names of raw files.
- Raw files are expected at code/xxx.raw now.
- Ignore network objects not generated by Netspoc.
- Restrict accepted line number of ASA 8.4 NAT to 1.

1.052     2012-02-13

- Fixed error while reading AAA_CREDENTIALS 

1.051     2012-02-12

- Added support of changed NAT for ASA 8.4.
- Removed unused password cruft. 

1.050     2012-01-23

- Fixed named port number 'sip' to 5060, 5600 was wrong
- Add support for anyconnect clients of ASA 8.4

1.049    2011-12-19

- Support ASA version 8.2- and 8.4-syntax for transform-set 
  of "crypto-map"-command.

1.048    2011-12-13

- Added support for more named port numbers: 
  sip => 5600, rtsp => 554

