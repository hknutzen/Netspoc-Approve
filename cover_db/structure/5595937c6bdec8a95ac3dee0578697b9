{"start":{"702":{"check_device_interfaces":[{"condition":13,"subroutine":24,"statement":261,"time":null,"branch":53}]},"32":{"BEGIN":[{"branch":null,"subroutine":1,"condition":null,"time":null,"statement":3}]},"216":{"udp_name2num":[{"branch":null,"condition":null,"subroutine":7,"statement":20,"time":null}]},"531":{"merge_acls":[{"branch":38,"subroutine":15,"condition":10,"time":null,"statement":173}]},"1399":{"equalize_acl":[{"subroutine":42,"condition":37,"time":null,"statement":561,"branch":120}]},"959":{"acl_entry2key0":[{"branch":80,"statement":376,"time":null,"condition":22,"subroutine":32}]},"1029":{"fix_transfer_groups":[{"statement":408,"time":null,"condition":27,"subroutine":36,"branch":90}]},"756":{"checkinterfaces":[{"branch":63,"statement":287,"time":null,"condition":18,"subroutine":26}]},"794":{"sort_object_group":[{"branch":64,"condition":18,"subroutine":27,"statement":292,"time":null}]},"1134":{"check_max_acl_entries":[{"branch":103,"condition":32,"subroutine":39,"statement":462,"time":null}]},"726":{"check_spoc_interfaces":[{"branch":59,"subroutine":25,"condition":14,"time":null,"statement":273}]},"935":{"mark_object_group_from_acl":[{"condition":21,"subroutine":30,"statement":364,"time":null,"branch":77}]},"-1":{"__COVER__":[{"subroutine":43,"condition":38,"time":null,"statement":563,"branch":120}]},"620":{"route_del":[{"branch":44,"subroutine":21,"condition":11,"time":null,"statement":216}]},"436":{"parse_port":[{"branch":23,"statement":127,"time":null,"condition":6,"subroutine":11}]},"1165":{"equalize_acl_entries":[{"condition":33,"subroutine":40,"statement":467,"time":null,"branch":104}]},"468":{"parse_port_spec":[{"branch":28,"condition":8,"subroutine":12,"statement":140,"time":null}]},"915":{"check_object_group":[{"condition":19,"subroutine":29,"statement":357,"time":null,"branch":75}]},"170":{"tcp_name2num":[{"branch":null,"subroutine":6,"condition":null,"time":null,"statement":18}]},"1006":{"acl_entry2key":[{"branch":90,"time":null,"statement":404,"subroutine":34,"condition":27}]},"36":{"BEGIN":[{"subroutine":5,"condition":null,"time":null,"statement":15,"branch":null}]},"808":{"equalize_obj_group":[{"subroutine":28,"condition":18,"time":null,"statement":300,"branch":64}]},"1331":{"__ANON__":[{"condition":37,"subroutine":41,"statement":561,"time":null,"branch":120}]},"34":{"BEGIN":[{"subroutine":3,"condition":null,"time":null,"statement":9,"branch":null}]},"1057":{"equalize_acl_groups":[{"branch":97,"statement":425,"time":null,"condition":28,"subroutine":37}]},"625":{"get_identity":[{"condition":11,"subroutine":22,"statement":218,"time":null,"branch":44}]},"634":{"login_enable":[{"time":null,"statement":222,"subroutine":23,"condition":11,"branch":44}]},"33":{"BEGIN":[{"branch":null,"time":null,"statement":6,"subroutine":2,"condition":null}]},"1106":{"subst_ace_name_og":[{"branch":101,"time":null,"statement":451,"subroutine":38,"condition":30}]},"1014":{"acl_entry_no_log2key":[{"branch":90,"subroutine":35,"condition":27,"time":null,"statement":406}]},"610":{"write_mem":[{"subroutine":19,"condition":11,"time":null,"statement":212,"branch":44}]},"615":{"route_add":[{"branch":44,"time":null,"statement":214,"subroutine":20,"condition":11}]},"520":{"normalize_proto":[{"time":null,"statement":168,"subroutine":14,"condition":9,"branch":36}]},"35":{"BEGIN":[{"branch":null,"condition":null,"subroutine":4,"statement":12,"time":null}]},"593":{"enter_conf_mode":[{"statement":204,"time":null,"condition":11,"subroutine":16,"branch":44}]},"942":{"mark_object_group_from_acl_entry":[{"condition":21,"subroutine":31,"statement":368,"time":null,"branch":77}]},"599":{"leave_conf_mode":[{"time":null,"statement":207,"subroutine":17,"condition":11,"branch":44}]},"431":{"adjust_mask":[{"branch":23,"statement":125,"time":null,"condition":6,"subroutine":10}]},"1001":{"acl_entry_abstract2key":[{"statement":402,"time":null,"condition":27,"subroutine":33,"branch":90}]},"232":{"analyze_conf_lines":[{"branch":null,"condition":null,"subroutine":8,"statement":22,"time":null}]},"505":{"parse_icmp_spec":[{"condition":8,"subroutine":13,"statement":158,"time":null,"branch":34}]},"605":{"check_conf_mode":[{"branch":44,"statement":210,"time":null,"condition":11,"subroutine":18}]},"31":{"BEGIN":[{"branch":null,"statement":null,"time":null,"condition":null,"subroutine":null}]},"413":{"parse_address":[{"branch":21,"condition":5,"subroutine":9,"statement":115,"time":null}]}},"branch":[[246,{"text":"if ($line =~ /$end_banner_regex/) { }"}],[245,{"text":"if (my $cmd = $in_banner)"}],[256,{"text":"if $line =~ /^ *!/"}],[259,{"text":"if $line =~ /^\\s*$/"}],[279,{"text":"unless ($parse_info and keys %$parse_info)"}],[274,{"text":"if ($first_subcmd) { }"}],[299,{"text":"if ($level + 1 == $sub_level and $rest eq 'quit') { }"}],[298,{"text":"if ($sub_level != $level)"}],[265,{"text":"if ($sub_level == $level) { }"}],[265,{"text":"elsif ($sub_level > $level) { }"}],[328,{"text":"if ($next = $prefix_info->{$prefix}) { }"}],[328,{"text":"elsif ($next = $prefix_info->{'_any'}) { }"}],[328,{"text":"elsif ($next = $prefix_info->{'_skip'}) { }"}],[349,{"text":"unless keys %$next"}],[319,{"text":"if (my $prefix_info = $parse_info->{'_prefix'})"}],[356,{"text":"unless ($lookup)"}],[371,{"text":"if (my $subcmd = $cmd_info->{'subcmd'}) { }"}],[371,{"text":"elsif ($end_banner_regex = $cmd_info->{'banner'}) { }"}],[397,{"text":"if $strict eq 'err'"}],[395,{"text":"if ($strict)"}],[359,{"text":"if (my $cmd_info = $parse_info->{$lookup} || $parse_info->{'_any'}) { }"}],[416,{"text":"if ($token eq 'any' or $token eq 'any4') { }"}],[416,{"text":"elsif ($token eq 'host') { }"}],[440,{"text":"if $port =~ /^\\d+$/"}],[454,{"text":"if ($tcp and $udp and $tcp == $udp) { }"}],[443,{"text":"if ($proto eq 'tcp') { }"}],[443,{"text":"elsif ($proto eq 'udp') { }"}],[461,{"text":"unless defined $port"}],[470,{"text":"unless my $spec = check_regex('eq|gt|lt|neq|range', $arg)"}],[473,{"text":"if ($spec eq 'eq') { }"}],[473,{"text":"elsif ($spec eq 'gt') { }"}],[473,{"text":"elsif ($spec eq 'lt') { }"}],[473,{"text":"elsif ($spec eq 'neq') { }"}],[473,{"text":"elsif ($spec eq 'range') { }"}],[508,{"text":"unless defined $token"}],[509,{"text":"if (my $spec = $ICMP_Names{$token}) { }"}],[522,{"text":"unless $proto =~ /^(?:\\d+|icmp|tcp|udp)$/"}],[524,{"text":"if $proto =~ /^(1|6|17)$/"}],[537,{"text":"unless ($spoc_intf)"}],[562,{"text":"if ($$spoc_entries[$index - 1]{'MODE'} eq 'deny') { }"}],[556,{"text":"if ($append) { }"}],[581,{"text":"if $spoc->{'ACCESS_LIST'}{$raw_name}"}],[549,{"text":"if (my $spoc_name = $spoc_intf->{$access_group}) { }"}],[546,{"text":"if (my $raw_name = $raw_intf->{$access_group})"}],[646,{"text":"unless $expect->spawn(\"$^X $cmd\")"}],[650,{"text":"unless $expect->spawn('ssh', '-l', $user, $ip)"}],[645,{"text":"if (my $cmd = $ENV{'SIMULATE_ROUTER'}) { }"}],[655,{"text":"if ($result->{'ERROR'})"}],[660,{"text":"if ($match =~ m[\\(yes/no\\)\\?]i)"}],[677,{"text":"if ($con->{'RESULT'}{'MATCH'} ne '#')"}],[683,{"text":"if ($con->{'RESULT'}{'MATCH'} ne '#')"}],[672,{"text":"if ($match eq '>') { }"}],[672,{"text":"elsif ($match ne '#') { }"}],[707,{"text":"if $conf_intf->{'SHUTDOWN'}"}],[708,{"text":"unless $conf_intf->{'ADDRESS'} or $conf_intf->{'UNNUMBERED'}"}],[712,{"text":"$conf_intf->{'INSPECT'} ? :"}],[713,{"text":"$spoc_intf->{'INSPECT'} ? :"}],[714,{"text":"unless $conf_inspect eq $spoc_inspect"}],[709,{"text":"if (my $spoc_intf = $spoc->{'IF'}{$name}) { }"}],[736,{"text":"unless $conf_vrf eq $spoc_vrf"}],[744,{"text":"if ($has_mpls and $name =~ /^mpls/ and $spoc_intf->{'UNNUMBERED'})"}],[731,{"text":"if (my $conf_intf = $conf->{'IF'}{$name}) { }"}],[752,{"text":"if @errors"}],[762,{"text":"if (grep {/^(?:ACCESS_LIST|CRYPTO)/;} keys %$spoc)"}],[818,{"text":"if ($conf_group->{'name'} ne $other_conf_group_name) { }"}],[816,{"text":"if (my $other_conf_group_name = $spoc_group->{'name_on_dev'})"}],[833,{"text":"if (my $other_spoc_group = $conf_group->{'needed'})"}],[841,{"text":"if ($spoc_group->{'transfer'} and $spoc_group->{'fixed'})"}],[846,{"text":"if ($conf_group->{'TYPE'} ne $spoc_group->{'TYPE'})"}],[867,{"text":"if ($diff->Diff)"}],[878,{"text":"if ($spoc_group->{'transfer'})"}],[874,{"text":"if (not $change_lines) { }"}],[874,{"text":"elsif ($change_lines >= @$spoc_networks) { }"}],[900,{"text":"if $diff->Same"}],[906,{"text":"if ($spoc_group->{'transfer'})"}],[917,{"text":"if ($abstract) { }"}],[916,{"text":"if (ref $attr and my $group = $attr->{'GROUP'}) { }"}],[943,{"text":"if $acl_entry->{'REMARK'}"}],[947,{"text":"unless ($group->{'name_on_dev'})"}],[946,{"text":"if (my $group = ref $what && $what->{'GROUP'})"}],[961,{"text":"if (my $string = $e->{'REMARK'})"}],[964,{"text":"if ($e->{'UNKNOWN'})"}],[981,{"text":"defined $v ? :"}],[989,{"text":"if $e->{'ESTA'}"}],[977,{"text":"if ($e->{'TYPE'} eq 'icmp') { }"}],[977,{"text":"elsif ($e->{'TYPE'} eq 'tcp' or $e->{'TYPE'} eq 'udp') { }"}],[993,{"text":"if $e->{'LOG_MODE'}"}],[994,{"text":"if $e->{'LOG_LEVEL'}"}],[995,{"text":"if $e->{'LOG_INTERVAL'}"}],[991,{"text":"if (my $log = $e->{'LOG'} && !$ignore_log)"}],[1030,{"text":"unless keys %$dupl"}],[1031,{"text":"if $entry->{'REMARK'}"}],[1036,{"text":"if ($group->{'transfer'})"}],[1035,{"text":"if (ref $what and my $group = $what->{'GROUP'})"}],[1041,{"text":"unless @need_fix"}],[1043,{"text":"unless (keys %$abstract)"}],[1047,{"text":"unless $abstract->{$key}"}],[1072,{"text":"if $conf_entry->{'REMARK'}"}],[1079,{"text":"if ($self->equalize_obj_group($conf_group, $spoc_group)) { }"}],[1076,{"text":"if (my $conf_group = ref $what && $what->{'GROUP'})"}],[1066,{"text":"if ($diff->Same) { }"}],[1117,{"text":"unless my $new_gid = $group->{'name_on_dev'} || $group->{'transfer'} && $group->{'new_name'}"}],[1114,{"text":"if (my $group = ref $what && $what->{'GROUP'})"}],[1137,{"text":"if ($incr > 1 and @$entries >= $incr)"}],[1223,{"text":"if $dupl{$key}"}],[1221,{"text":"unless ($conf_entry->{'REMARK'})"}],[1218,{"text":"if ($diff->Diff & 1)"}],[1249,{"text":"if not $add_incr and $prev_entry"}],[1267,{"text":"if ($self->is_device_access($conf_entry))"}],[1278,{"text":"if ($device_line{$next_conf_entry} < $device_line{$conf_entry}) { }"}],[1262,{"text":"if (not $spoc_entry->{'REMARK'} and my $conf_entry = $dupl{$key}) { }"}],[1235,{"text":"if ($diff->Diff & 2)"}],[1319,{"text":"unless @add or @delete"}],[1335,{"text":"if ($line = $device_line{$next_entry})"}],[1347,{"text":"if (my $conf_entry = $move_up{$spoc_entry})"}],[1358,{"text":"$vcmd1 ? :"}],[1366,{"text":"if $moved{$conf_entry}"}],[1372,{"text":"if (my $spoc_entry = $move_down{$conf_entry})"}],[1379,{"text":"$vcmd2 ? :"}],[1382,{"text":"if (@vcmds) { }"}]],"file":"lib/Netspoc/Approve/Cisco.pm","subroutine":[[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[34,"BEGIN"],[35,"BEGIN"],[36,"BEGIN"],[170,"tcp_name2num"],[216,"udp_name2num"],[232,"analyze_conf_lines"],[413,"parse_address"],[431,"adjust_mask"],[436,"parse_port"],[468,"parse_port_spec"],[505,"parse_icmp_spec"],[520,"normalize_proto"],[531,"merge_acls"],[593,"enter_conf_mode"],[599,"leave_conf_mode"],[605,"check_conf_mode"],[610,"write_mem"],[615,"route_add"],[620,"route_del"],[625,"get_identity"],[634,"login_enable"],[702,"check_device_interfaces"],[726,"check_spoc_interfaces"],[756,"checkinterfaces"],[794,"sort_object_group"],[808,"equalize_obj_group"],[915,"check_object_group"],[935,"mark_object_group_from_acl"],[942,"mark_object_group_from_acl_entry"],[959,"acl_entry2key0"],[1001,"acl_entry_abstract2key"],[1006,"acl_entry2key"],[1014,"acl_entry_no_log2key"],[1029,"fix_transfer_groups"],[1057,"equalize_acl_groups"],[1106,"subst_ace_name_og"],[1134,"check_max_acl_entries"],[1165,"equalize_acl_entries"],[1331,"__ANON__"],[1399,"equalize_acl"]],"condition":[[279,{"op":"and","type":"and_3","right":"keys %$parse_info","left":"$parse_info"}],[293,{"left":"$sub_level < $level","right":"@stack","type":"and_3","op":"and"}],[299,{"type":"and_3","op":"and","right":"$rest eq 'quit'","left":"$level + 1 == $sub_level"}],[359,{"type":"or_3","op":"||","right":"$parse_info->{'_any'}","left":"$parse_info->{$lookup}"}],[376,{"type":"or_3","op":"||=","right":"$cmd_info->{'strict'}","left":"$strict"}],[416,{"op":"or","type":"or_3","right":"$token eq 'any4'","left":"$token eq 'any'"}],[454,{"right":"$udp","left":"$tcp","type":"and_3","op":"and"}],[454,{"right":"$tcp == $udp","left":"$tcp and $udp","op":"and","type":"and_3"}],[514,{"left":"check_regex('\\\\d+', $arg)","right":"-1","op":"||","type":"or_2"}],[521,{"type":"or_3","op":"||","left":"$IP_Names{$proto}","right":"$proto"}],[554,{"left":"$spoc->{'ACCESS_LIST'}{$spoc_name}{'LIST'}","right":"[]","op":"||=","type":"or_2"}],[667,{"op":"||=","type":"or_3","left":"$pass","right":"$self->get_user_password($user)"}],[680,{"left":"$self->{'ENABLE_PASS'}","right":"$pass","type":"or_3","op":"||"}],[708,{"right":"$conf_intf->{'UNNUMBERED'}","left":"$conf_intf->{'ADDRESS'}","op":"or","type":"or_3"}],[734,{"type":"or_2","op":"||","left":"$spoc_intf->{'VRF'}","right":"'-'"}],[735,{"left":"$conf_intf->{'VRF'}","right":"'-'","op":"||","type":"or_2"}],[744,{"left":"$has_mpls","right":"$name =~ /^mpls/","type":"and_3","op":"and"}],[744,{"type":"and_3","op":"and","left":"$has_mpls and $name =~ /^mpls/","right":"$spoc_intf->{'UNNUMBERED'}"}],[841,{"left":"$spoc_group->{'transfer'}","right":"$spoc_group->{'fixed'}","op":"and","type":"and_3"}],[916,{"type":"and_3","op":"and","left":"ref $attr","right":"my $group = $attr->{'GROUP'}"}],[925,{"right":"$group->{'name'}","left":"$group->{'name_on_dev'} || $group->{'transfer'} && $group->{'new_name'}","op":"||","type":"or_3"}],[946,{"type":"and_3","op":"&&","left":"ref $what","right":"$what->{'GROUP'}"}],[972,{"op":"||","type":"or_3","right":"\"$what->{'BASE'}/$what->{'MASK'}\"","left":"check_object_group($what, $abstract)"}],[976,{"op":"||","type":"or_3","right":"$e->{'TYPE'}","left":"check_object_group($e->{'TYPE'})"}],[977,{"op":"or","type":"or_3","right":"$e->{'TYPE'} eq 'udp'","left":"$e->{'TYPE'} eq 'tcp'"}],[987,{"op":"||","type":"or_3","right":"\"$port->{'LOW'}:$port->{'HIGH'}\"","left":"check_object_group($port)"}],[991,{"op":"&&","type":"and_3","left":"$e->{'LOG'}","right":"!$ignore_log"}],[1035,{"op":"and","type":"and_3","left":"ref $what","right":"my $group = $what->{'GROUP'}"}],[1076,{"left":"ref $what","right":"$what->{'GROUP'}","type":"and_3","op":"&&"}],[1078,{"op":"&&","type":"and_3","left":"ref $what","right":"$what->{'GROUP'}"}],[1114,{"right":"$what->{'GROUP'}","left":"ref $what","type":"and_3","op":"&&"}],[1117,{"op":"||","type":"or_3","left":"$group->{'name_on_dev'}","right":"$group->{'transfer'} && $group->{'new_name'}"}],[1137,{"left":"$incr > 1","right":"@$entries >= $incr","op":"and","type":"and_3"}],[1237,{"right":"'LAST'","left":"$conf_entries->[$conf_next]","op":"||","type":"or_2"}],[1249,{"right":"$prev_entry","left":"not $add_incr","type":"and_3","op":"and"}],[1262,{"op":"and","type":"and_3","left":"not $spoc_entry->{'REMARK'}","right":"my $conf_entry = $dupl{$key}"}],[1319,{"left":"@add","right":"@delete","type":"or_3","op":"or"}],[1400,{"right":"$self->equalize_acl_entries($conf_acl, $spoc_acl)","left":"$self->equalize_acl_groups($conf_acl, $spoc_acl)","type":"or_3","op":"||"}]],"digest":"5595937c6bdec8a95ac3dee0578697b9","statement":[31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,170,171,216,217,232,233,234,235,236,237,238,239,240,242,243,245,246,247,250,250,252,256,259,262,263,265,274,279,280,281,282,284,287,293,294,294,298,299,303,309,310,311,312,319,320,321,322,323,324,325,326,327,328,329,330,331,332,335,336,337,338,341,342,347,349,350,352,353,354,356,357,359,364,370,371,372,373,374,375,376,377,378,381,382,390,391,392,393,394,395,396,397,398,402,403,403,405,413,414,415,416,417,420,421,424,425,427,431,432,436,437,440,443,444,447,452,453,454,455,458,461,462,468,469,470,472,473,474,475,478,479,480,483,484,485,488,491,492,495,497,505,506,507,508,509,510,510,513,514,516,520,521,522,524,527,531,533,533,534,535,537,538,540,544,545,546,547,549,552,554,555,556,557,560,561,562,563,566,569,572,573,575,576,581,584,585,593,594,595,599,600,601,605,606,610,611,615,616,620,621,625,626,629,630,634,635,636,636,641,643,644,645,646,650,653,654,655,656,659,660,661,662,663,665,666,667,668,669,671,672,675,676,677,680,681,683,684,688,693,694,695,696,697,702,704,705,705,706,707,708,709,712,713,714,720,726,728,729,729,730,731,734,735,736,744,745,746,749,752,756,762,762,763,766,794,795,796,797,800,798,799,800,808,816,818,819,821,824,833,834,835,836,838,841,842,843,846,847,848,849,851,857,858,859,860,861,865,866,867,868,869,874,875,876,877,878,879,881,883,884,889,890,891,892,896,897,898,899,900,901,901,902,902,904,905,906,907,909,911,915,916,917,918,925,926,930,935,936,936,937,942,943,944,945,946,947,948,949,959,961,962,964,965,968,969,970,971,972,976,977,978,979,980,981,985,986,987,989,991,992,993,994,995,997,1001,1002,1006,1007,1014,1015,1029,1030,1031,1032,1033,1034,1035,1036,1037,1041,1043,1044,1044,1046,1047,1048,1049,1057,1058,1059,1060,1061,1063,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1081,1084,1093,1097,1098,1102,1106,1107,1110,1112,1113,1114,1115,1117,1124,1129,1130,1134,1135,1136,1137,1138,1165,1166,1167,1168,1170,1175,1182,1186,1189,1194,1197,1200,1205,1207,1211,1212,1214,1217,1218,1219,1221,1222,1223,1225,1227,1233,1234,1235,1236,1237,1238,1239,1240,1244,1249,1252,1254,1255,1260,1261,1262,1267,1268,1269,1271,1274,1278,1281,1282,1283,1295,1311,1313,1319,1321,1322,1325,1342,1331,1333,1334,1335,1337,1339,1341,1345,1346,1347,1348,1349,1351,1353,1354,1355,1356,1357,1358,1365,1366,1367,1368,1370,1371,1372,1373,1374,1375,1376,1377,1379,1382,1385,1386,1389,1399,1400]}