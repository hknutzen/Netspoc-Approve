{"file":"lib/Netspoc/Approve/Linux.pm","start":{"582":{"intersect_rule":[{"subroutine":22,"condition":13,"time":null,"statement":213,"branch":59}]},"29":{"BEGIN":[{"branch":null,"statement":null,"time":null,"condition":null,"subroutine":null}]},"1082":{"cmd_check_error":[{"branch":136,"time":null,"statement":474,"subroutine":35,"condition":31}]},"330":{"icmp2intern":[{"branch":21,"condition":6,"subroutine":14,"statement":112,"time":null}]},"279":{"mode2intern":[{"time":null,"statement":87,"subroutine":11,"condition":6,"branch":11}]},"1276":{"login_enable":[{"branch":153,"subroutine":51,"condition":34,"time":null,"statement":574}]},"50":{"get_parse_info":[{"branch":null,"condition":null,"subroutine":7,"statement":21,"time":null}]},"1248":{"get_config_from_device":[{"subroutine":46,"condition":34,"time":null,"statement":561,"branch":153}]},"225":{"parse_policy":[{"branch":6,"time":null,"statement":60,"subroutine":9,"condition":2}]},"1256":{"get_identity":[{"subroutine":47,"condition":34,"time":null,"statement":566,"branch":153}]},"1070":{"cmd_ok":[{"condition":31,"subroutine":34,"statement":471,"time":null,"branch":136}]},"31":{"BEGIN":[{"condition":null,"subroutine":2,"statement":6,"time":null,"branch":null}]},"711":{"expand_chain":[{"time":null,"statement":280,"subroutine":24,"condition":21,"branch":93}]},"1152":{"find_iptables_restore_cmd":[{"branch":144,"time":null,"statement":507,"subroutine":42,"condition":32}]},"851":{"merge_acls":[{"statement":348,"time":null,"condition":22,"subroutine":27,"branch":108}]},"508":{"normalize":[{"branch":41,"condition":8,"subroutine":21,"statement":170,"time":null}]},"407":{"rule_code":[{"time":null,"statement":151,"subroutine":20,"condition":7,"branch":31}]},"150":{"analyze_conf_lines":[{"condition":null,"subroutine":8,"statement":24,"time":null,"branch":null}]},"1106":{"route_add":[{"subroutine":38,"condition":32,"time":null,"statement":482,"branch":139}]},"33":{"BEGIN":[{"branch":null,"condition":null,"subroutine":4,"statement":12,"time":null}]},"934":{"compare_rules":[{"branch":117,"subroutine":30,"condition":25,"time":null,"statement":395}]},"1118":{"do_scp":[{"branch":139,"condition":32,"subroutine":40,"statement":488,"time":null}]},"294":{"prefix2intern":[{"condition":6,"subroutine":12,"statement":92,"time":null,"branch":13}]},"925":{"postprocess_config":[{"branch":117,"statement":392,"time":null,"condition":25,"subroutine":29}]},"35":{"BEGIN":[{"branch":null,"condition":null,"subroutine":6,"statement":18,"time":null}]},"30":{"BEGIN":[{"branch":null,"condition":null,"subroutine":1,"statement":3,"time":null}]},"317":{"range2intern":[{"statement":105,"time":null,"condition":6,"subroutine":13,"branch":18}]},"1159":{"write_startup_iptables":[{"time":null,"statement":510,"subroutine":43,"condition":32,"branch":145}]},"1261":{"parse_version":[{"branch":153,"statement":568,"time":null,"condition":34,"subroutine":48}]},"1096":{"enter_conf_mode":[{"subroutine":36,"condition":32,"time":null,"statement":480,"branch":139}]},"-1":{"__COVER__":[{"branch":158,"time":null,"statement":597,"subroutine":52,"condition":34}]},"1218":{"write_mem":[{"branch":150,"subroutine":45,"condition":33,"time":null,"statement":547}]},"1271":{"search_banner":[{"condition":34,"subroutine":50,"statement":572,"time":null,"branch":153}]},"1064":{"status_ok":[{"time":null,"statement":468,"subroutine":33,"condition":30,"branch":136}]},"965":{"chains_equal":[{"subroutine":31,"condition":26,"time":null,"statement":413,"branch":124}]},"1111":{"route_del":[{"branch":139,"condition":32,"subroutine":39,"statement":484,"time":null}]},"336":{"mask2prefix":[{"time":null,"statement":115,"subroutine":15,"condition":6,"branch":21}]},"34":{"BEGIN":[{"condition":null,"subroutine":5,"statement":15,"time":null,"branch":null}]},"237":{"parse_rule":[{"branch":7,"statement":64,"time":null,"condition":2,"subroutine":10}]},"906":{"postprocess_routes":[{"statement":381,"time":null,"condition":23,"subroutine":28,"branch":113}]},"1101":{"leave_conf_mode":[{"subroutine":37,"condition":32,"time":null,"statement":481,"branch":139}]},"363":{"prefix_code":[{"condition":6,"subroutine":17,"statement":128,"time":null,"branch":24}]},"348":{"mode_code":[{"branch":22,"time":null,"statement":123,"subroutine":16,"condition":6}]},"766":{"convert_rules":[{"branch":100,"subroutine":25,"condition":22,"time":null,"statement":302}]},"1267":{"set_terminal":[{"time":null,"statement":571,"subroutine":49,"condition":34,"branch":153}]},"1025":{"process_iptables":[{"branch":131,"subroutine":32,"condition":30,"time":null,"statement":442}]},"1134":{"write_startup_routing":[{"time":null,"statement":495,"subroutine":41,"condition":32,"branch":142}]},"1190":{"transfer":[{"statement":534,"time":null,"condition":33,"subroutine":44,"branch":147}]},"812":{"postprocess_iptables":[{"branch":104,"condition":22,"subroutine":26,"statement":325,"time":null}]},"32":{"BEGIN":[{"condition":null,"subroutine":3,"statement":9,"time":null,"branch":null}]},"371":{"range_code":[{"branch":25,"condition":6,"subroutine":18,"statement":134,"time":null}]},"656":{"disjoint":[{"statement":251,"time":null,"condition":18,"subroutine":23,"branch":77}]},"391":{"icmp_code":[{"time":null,"statement":143,"subroutine":19,"condition":7,"branch":29}]}},"branch":[[160,{"text":"if $line =~ /^\\s*#/"}],[163,{"text":"if $line =~ /^\\s*$/"}],[171,{"text":"if ($args[0] =~ /^([*:])(.*)$/)"}],[175,{"text":"if (my $prefix_info = $parse_info->{'_prefix'})"}],[201,{"text":"if (my $subcmd = $parse_info->{$cmd}{'subcmd'})"}],[198,{"text":"if (my $cmd_info = $parse_info->{$cmd}) { }"}],[232,{"text":"$policy eq '-' ? :"}],[248,{"text":"if ($key eq '!')"}],[257,{"text":"if (not @args) { }"}],[267,{"text":"if ($key eq '--tcp-flags' and $v = '!FIN,SYN,RST,ACK SYN')"}],[273,{"text":"if $negate_next_cmd"}],[280,{"text":"if ($token eq 'ACCEPT') { }"}],[280,{"text":"elsif ($token eq 'DROP') { }"}],[298,{"text":"unless defined $base"}],[301,{"text":"unless $prefix <= 32"}],[307,{"text":"unless defined $mask"}],[300,{"text":"if ($prefix =~ /^\\d+$/) { }"}],[299,{"text":"if (defined $prefix) { }"}],[320,{"text":"if $low eq ''"}],[321,{"text":"if $high eq ''"}],[319,{"text":"if (defined $high) { }"}],[339,{"text":"unless $mask & 2147483648"}],[349,{"text":"if ($mode eq 'permit') { }"}],[349,{"text":"elsif ($mode eq 'deny') { }"}],[367,{"text":"$prefix_code == 32 ? :"}],[373,{"text":"if ($v1 == $v2) { }"}],[373,{"text":"elsif ($v1 == 0 and $v2 == 65535) { }"}],[373,{"text":"elsif ($v2 == 65535) { }"}],[373,{"text":"elsif ($v1 == 0) { }"}],[394,{"text":"if (defined $code) { }"}],[393,{"text":"if (defined $type) { }"}],[411,{"text":"if $src->{'BASE'} != 0"}],[412,{"text":"if $dst->{'BASE'} != 0"}],[419,{"text":"if defined $v"}],[421,{"text":"if defined $v"}],[422,{"text":"if $rule->{'ESTA'}"}],[427,{"text":"if defined $v"}],[413,{"text":"if ($type eq 'ip') { }"}],[413,{"text":"elsif ($type eq 'tcp' or $type eq 'udp') { }"}],[413,{"text":"elsif ($type eq 'icmp') { }"}],[432,{"text":"if $mode"}],[514,{"text":"if (lc $v eq lc $proto)"}],[512,{"text":"if (my $v = $rule->{'-m'})"}],[528,{"text":"if $v eq 'LOG'"}],[529,{"text":"unless ($v eq 'DROP' or $v eq 'ACCEPT')"}],[527,{"text":"unless ($chains->{$v})"}],[520,{"text":"if (not $rule->{'-j'} || $rule->{'-g'}) { }"}],[520,{"text":"elsif (my $v = $rule->{'-j'}) { }"}],[537,{"text":"if (not $v =~ m[/] or $v =~ m[/0xffffffff$]i)"}],[536,{"text":"if (my $v = $rule->{'--set-xmark'})"}],[544,{"text":"unless $key =~ /^-/"}],[546,{"text":"unless ($spec)"}],[550,{"text":"if $spec->{'non_comparable'}"}],[553,{"text":"unless $key =~ /^-/"}],[556,{"text":"unless ($spec)"}],[560,{"text":"unless defined $size"}],[561,{"text":"unless @{[split(' ', $v, 0)];} == $size"}],[564,{"text":"if ($v =~ /^!/)"}],[569,{"text":"if ($spec->{'must_negate'} xor $negate)"}],[594,{"text":"if $m1 > $m2"}],[597,{"text":"unless ($b2 & $m1) == $b1"}],[603,{"text":"$l1 > $l2 ? :"}],[604,{"text":"$h1 < $h2 ? :"}],[605,{"text":"unless $max <= $min"}],[611,{"text":"unless $t1 == $t2"}],[613,{"text":"$c1 == $c2 ? :"}],[613,{"text":"!defined($c2) ? :"}],[613,{"text":"!defined($c1) ? :"}],[625,{"text":"unless $v1 eq $v2"}],[588,{"text":"if ($k1 eq '-s' or $k1 eq '-d') { }"}],[588,{"text":"elsif ($k1 eq '--sport' or $k1 eq '--dport') { }"}],[588,{"text":"elsif ($k1 eq '--icmp-type') { }"}],[588,{"text":"elsif ($k1 eq '-p') { }"}],[588,{"text":"elsif ($k1 eq '-j' or $k1 eq '-g') { }"}],[588,{"text":"elsif ($k1 eq 'name' or $k1 eq 'line' or $k1 eq 'orig') { }"}],[586,{"text":"if (exists $rule2->{$k1}) { }"}],[647,{"text":"if exists $rule1->{$k2}"}],[668,{"text":"if $m1 > $m2"}],[671,{"text":"unless ($b2 & $m1) == $b1"}],[676,{"text":"$l1 > $l2 ? :"}],[677,{"text":"$h1 < $h2 ? :"}],[678,{"text":"unless $max <= $min"}],[683,{"text":"unless $t1 == $t2"}],[684,{"text":"$c1 == $c2 ? :"}],[684,{"text":"!defined($c2) ? :"}],[684,{"text":"!defined($c1) ? :"}],[695,{"text":"unless $v1 eq $v2"}],[662,{"text":"if ($k1 eq '-s' or $k1 eq '-d') { }"}],[662,{"text":"elsif ($k1 eq '--sport' or $k1 eq '--dport') { }"}],[662,{"text":"elsif ($k1 eq '--icmp-type') { }"}],[662,{"text":"elsif ($k1 eq '-p') { }"}],[662,{"text":"elsif ($k1 eq '-j' or $k1 eq '-g') { }"}],[660,{"text":"if (exists $rule2->{$k1})"}],[712,{"text":"if $chain->{'EXPANDED'}"}],[723,{"text":"unless disjoint($rule->{'intern'}, $next->{'intern'})"}],[720,{"text":"if ($rule->{'-g'})"}],[729,{"text":"unless my $target = $rule->{'-j'} || $rule->{'-g'}"}],[733,{"text":"if $target eq 'LOG'"}],[736,{"text":"unless ($chains->{$target})"}],[742,{"text":"if $called_chain->{'NON_COMPARABLE'}"}],[775,{"text":"unless $key =~ /^-/"}],[779,{"text":"if (my $spec = $iptables2intern{$key}) { }"}],[790,{"text":"unless defined $default"}],[791,{"text":"unless (exists $converted->{$key})"}],[823,{"text":"if $policies->{$name}"}],[827,{"text":"if $new->{$name}"}],[840,{"text":"if $chain->{'NON_COMPARABLE'}"}],[844,{"text":"if $chain->{'NON_COMPARABLE'}"}],[860,{"text":"unless ($spoc_chains)"}],[868,{"text":"unless ($spoc_chain)"}],[873,{"text":"unless ($spoc_chain->{'POLICY'})"}],[887,{"text":"if ($$spoc_entries[$index - 1]{-'j'} =~ /^drop/i) { }"}],[881,{"text":"if ($append) { }"}],[907,{"text":"unless $config->{'ROUTING'}"}],[914,{"text":"if $entry->{'SCOPE'} and $entry->{'SCOPE'} eq 'link'"}],[915,{"text":"if $entry->{'PROTO'} and $entry->{'PROTO'} ne 'static'"}],[916,{"text":"if ($entry->{'NEXTHOP'})"}],[935,{"text":"unless keys %$r1 == keys %$r2"}],[940,{"text":"unless $k =~ /^-/"}],[941,{"text":"if ($k eq '-j' or $k eq '-g')"}],[947,{"text":"unless $v2"}],[948,{"text":"unless $v1 eq $v2"}],[953,{"text":"unless defined $v2"}],[950,{"text":"if (my $k = $jump) { }"}],[970,{"text":"unless ($conf_chain->{'NON_COMPARABLE'} or $spoc_chain->{'NON_COMPARABLE'})"}],[981,{"text":"$c_name eq $s_name ? :"}],[985,{"text":"if ($conf_count != $spoc_count)"}],[999,{"text":"unless $self->chains_equal($c_chains, $s_chains, $c_chain, $s_chain, $context)"}],[997,{"text":"if ($c_chain and $s_chain) { }"}],[997,{"text":"elsif ($c_target ne $s_target) { }"}],[992,{"text":"if (my($c_target, $s_target) = compare_rules($conf_rules->[$i], $spoc_rules->[$i])) { }"}],[1033,{"text":"unless ($spoc_chains)"}],[1042,{"text":"unless $conf_chain->{'POLICY'}"}],[1044,{"text":"unless ($spoc_chain)"}],[1049,{"text":"unless $self->chains_equal($conf_chains, $spoc_chains, $conf_chain, $spoc_chain, $tname)"}],[1055,{"text":"unless ($conf_tables->{$tname})"}],[1085,{"text":"if (not @$lines == 1 && $valid && $lines->[0] eq $valid)"}],[1083,{"text":"if (@$lines) { }"}],[1083,{"text":"elsif (not $self->status_ok) { }"}],[1121,{"text":"$mode eq 'get' ? :"}],[1121,{"text":"$mode eq 'put' ? :"}],[1129,{"text":"unless system(@args) == 0"}],[1139,{"text":"unless my($fh, $tmpname) = tempfile('UNLINK', 1)"}],[1147,{"text":"unless close $fh"}],[1153,{"text":"unless my $path = $self->get_cmd_output('which iptables-restore')->[0]"}],[1162,{"text":"unless my($fh, $tmpname) = tempfile('UNLINK', 1)"}],[1185,{"text":"unless close $fh"}],[1198,{"text":"if $self->{'COMPARE'}"}],[1201,{"text":"if ($self->{'CHANGE'}{'ROUTING'})"}],[1208,{"text":"if ($self->{'CHANGE'}{'ACL'})"}],[1223,{"text":"if ($self->{'CHANGE'}{'ROUTING'})"}],[1233,{"text":"if ($self->{'CHANGE'}{'ACL'})"}],[1239,{"text":"if (my $cmd = $config->{'store_flash_cmd'} and $self->cmd_ok('ls /etc/router-version'))"}],[1279,{"text":"unless $con->{'EXPECT'}->spawn('ssh', '-l', $config->{'user'}, $ip)"}],[1283,{"text":"if ($result->{'ERROR'})"}],[1286,{"text":"if ($con->{'RESULT'}{'MATCH'} =~ qr\"\\(yes/no\\)\\?\"i)"}],[1297,{"text":"unless ($con->{'RESULT'}{'MATCH'} =~ /$std_prompt/)"}],[1293,{"text":"if ($con->{'RESULT'}{'MATCH'} =~ qr/password:/i)"}]],"digest":"b721666e601153f6f1b084cf07897f02","statement":[29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,50,51,136,150,151,152,153,154,156,157,160,163,165,168,171,172,174,175,176,177,180,181,187,193,194,194,198,199,200,201,202,203,204,205,211,214,215,215,217,225,226,229,232,237,243,244,245,246,247,248,249,250,252,253,254,255,257,258,261,263,267,268,269,271,273,274,279,280,281,284,289,294,295,296,297,298,299,300,301,303,306,307,311,313,317,318,319,320,321,324,326,330,331,332,336,337,338,339,340,341,342,344,348,349,350,353,356,363,364,364,365,366,367,371,372,372,373,374,377,380,383,386,391,392,392,393,394,395,398,402,407,408,408,410,411,412,413,417,418,419,420,421,422,425,426,427,430,432,433,508,509,509,512,513,514,515,520,521,527,528,529,530,536,537,538,539,543,544,545,546,547,548,550,552,553,554,555,556,557,559,560,561,561,563,564,567,569,570,572,573,574,575,582,583,584,585,586,587,588,589,589,590,590,594,597,598,601,601,602,602,603,604,605,606,609,609,610,610,611,613,620,625,626,631,637,641,644,647,649,651,656,657,658,659,660,661,662,663,663,664,664,668,671,674,674,675,675,676,677,678,681,681,682,682,683,684,695,701,705,711,712,713,714,715,716,720,721,722,723,729,733,736,737,738,740,742,743,744,745,748,749,766,767,768,769,770,771,772,775,777,779,780,781,784,788,789,790,791,792,795,796,797,799,800,812,814,817,818,819,820,821,822,823,824,826,827,830,832,835,836,837,839,840,841,843,844,845,851,852,853,854,858,859,860,861,862,863,865,866,867,868,869,870,871,873,874,878,879,880,881,882,885,886,887,888,891,894,897,898,900,906,907,912,913,913,914,915,916,917,919,921,925,926,927,934,935,936,937,940,941,942,943,945,946,947,948,950,951,952,953,954,959,965,966,967,970,973,977,978,979,980,981,984,985,986,988,990,991,992,995,996,997,998,999,1004,1005,1007,1011,1012,1013,1016,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1038,1039,1042,1043,1044,1045,1046,1047,1049,1054,1055,1056,1057,1060,1064,1065,1066,1070,1073,1074,1082,1083,1084,1085,1086,1090,1096,1101,1106,1107,1111,1112,1113,1114,1118,1119,1120,1121,1127,1128,1129,1134,1135,1139,1140,1141,1142,1142,1143,1144,1145,1147,1148,1152,1153,1155,1159,1160,1161,1162,1164,1165,1166,1167,1168,1169,1170,1171,1172,1173,1175,1176,1177,1177,1178,1179,1180,1183,1185,1186,1190,1193,1196,1198,1201,1202,1203,1208,1209,1210,1211,1212,1213,1218,1221,1222,1223,1226,1227,1231,1232,1233,1234,1235,1239,1242,1243,1248,1250,1251,1252,1252,1256,1257,1261,1262,1263,1267,1271,1272,1276,1277,1278,1278,1279,1281,1282,1283,1284,1286,1287,1288,1289,1293,1294,1295,1296,1297,1298,1301,1307,1308,1309],"subroutine":[[29,"BEGIN"],[30,"BEGIN"],[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[34,"BEGIN"],[35,"BEGIN"],[50,"get_parse_info"],[150,"analyze_conf_lines"],[225,"parse_policy"],[237,"parse_rule"],[279,"mode2intern"],[294,"prefix2intern"],[317,"range2intern"],[330,"icmp2intern"],[336,"mask2prefix"],[348,"mode_code"],[363,"prefix_code"],[371,"range_code"],[391,"icmp_code"],[407,"rule_code"],[508,"normalize"],[582,"intersect_rule"],[656,"disjoint"],[711,"expand_chain"],[766,"convert_rules"],[812,"postprocess_iptables"],[851,"merge_acls"],[906,"postprocess_routes"],[925,"postprocess_config"],[934,"compare_rules"],[965,"chains_equal"],[1025,"process_iptables"],[1064,"status_ok"],[1070,"cmd_ok"],[1082,"cmd_check_error"],[1096,"enter_conf_mode"],[1101,"leave_conf_mode"],[1106,"route_add"],[1111,"route_del"],[1118,"do_scp"],[1134,"write_startup_routing"],[1152,"find_iptables_restore_cmd"],[1159,"write_startup_iptables"],[1190,"transfer"],[1218,"write_mem"],[1248,"get_config_from_device"],[1256,"get_identity"],[1261,"parse_version"],[1267,"set_terminal"],[1271,"search_banner"],[1276,"login_enable"]],"condition":[[177,{"op":"and","type":"and_3","right":"keys %$prefix_info","left":"$prefix_info = $prefix_info->{$prefix}"}],[193,{"op":"and","type":"and_3","right":"@stack","left":"not $parse_info->{$cmd}"}],[249,{"op":"||=","type":"or_3","right":"$key","left":"$negate"}],[253,{"right":"''","left":"check_regex(qr/!/, $arg)","op":"||","type":"or_2"}],[261,{"right":"$negate_arg","left":"$negate","type":"or_3","op":"||="}],[267,{"left":"$key eq '--tcp-flags'","right":"$v = '!FIN,SYN,RST,ACK SYN'","op":"and","type":"and_2"}],[373,{"op":"and","type":"and_3","left":"$v1 == 0","right":"$v2 == 65535"}],[413,{"type":"or_3","op":"or","left":"$type eq 'tcp'","right":"$type eq 'udp'"}],[513,{"left":"$rule->{'-p'}","right":"''","type":"or_2","op":"||"}],[520,{"left":"$rule->{'-j'}","right":"$rule->{'-g'}","op":"||","type":"or_3"}],[529,{"left":"$v eq 'DROP'","right":"$v eq 'ACCEPT'","op":"or","type":"or_3"}],[537,{"left":"not $v =~ m[/]","right":"$v =~ m[/0xffffffff$]i","type":"or_3","op":"or"}],[569,{"right":"$negate","left":"$spec->{'must_negate'}","type":"xor_4","op":"xor"}],[588,{"type":"or_3","op":"or","right":"$k1 eq '-d'","left":"$k1 eq '-s'"}],[588,{"left":"$k1 eq '--sport'","right":"$k1 eq '--dport'","op":"or","type":"or_3"}],[588,{"right":"$k1 eq '-g'","left":"$k1 eq '-j'","type":"or_3","op":"or"}],[588,{"left":"$k1 eq 'name'","right":"$k1 eq 'line'","op":"or","type":"or_3"}],[588,{"type":"or_3","op":"or","right":"$k1 eq 'orig'","left":"$k1 eq 'name' or $k1 eq 'line'"}],[662,{"op":"or","type":"or_3","right":"$k1 eq '-d'","left":"$k1 eq '-s'"}],[662,{"op":"or","type":"or_3","left":"$k1 eq '--sport'","right":"$k1 eq '--dport'"}],[662,{"op":"or","type":"or_3","left":"$k1 eq '-j'","right":"$k1 eq '-g'"}],[729,{"op":"||","type":"or_3","left":"$rule->{'-j'}","right":"$rule->{'-g'}"}],[879,{"type":"or_2","op":"||=","right":"[]","left":"$spoc_chain->{'RULES'}"}],[914,{"type":"and_3","op":"and","left":"$entry->{'SCOPE'}","right":"$entry->{'SCOPE'} eq 'link'"}],[915,{"right":"$entry->{'PROTO'} ne 'static'","left":"$entry->{'PROTO'}","op":"and","type":"and_3"}],[941,{"right":"$k eq '-g'","left":"$k eq '-j'","op":"or","type":"or_3"}],[970,{"right":"$spoc_chain->{'NON_COMPARABLE'}","left":"$conf_chain->{'NON_COMPARABLE'}","op":"or","type":"or_3"}],[977,{"op":"||","type":"or_2","right":"[]","left":"$conf_chain->{'RULES'}"}],[978,{"type":"or_2","op":"||","left":"$spoc_chain->{'RULES'}","right":"[]"}],[997,{"right":"$s_chain","left":"$c_chain","op":"and","type":"and_3"}],[1066,{"right":"$status->[0] eq '0'","left":"@$status == 1","type":"and_3","op":"&&"}],[1085,{"left":"@$lines == 1 && $valid","right":"$lines->[0] eq $valid","op":"&&","type":"and_3"}],[1172,{"op":"||","type":"or_2","right":"'-'","left":"$chain->{'POLICY'}"}],[1239,{"type":"and_3","op":"and","right":"$self->cmd_ok('ls /etc/router-version')","left":"my $cmd = $config->{'store_flash_cmd'}"}]]}