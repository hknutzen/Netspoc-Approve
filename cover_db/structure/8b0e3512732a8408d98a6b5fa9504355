{"digest":"8b0e3512732a8408d98a6b5fa9504355","subroutine":[[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[34,"BEGIN"],[35,"BEGIN"],[36,"BEGIN"],[170,"tcp_name2num"],[216,"udp_name2num"],[232,"analyze_conf_lines"],[415,"parse_address"],[433,"adjust_mask"],[438,"parse_port"],[470,"parse_port_spec"],[504,"parse_icmp_spec"],[519,"normalize_proto"],[530,"merge_acls"],[592,"enter_conf_mode"],[598,"leave_conf_mode"],[604,"check_conf_mode"],[609,"write_mem"],[614,"route_add"],[619,"route_del"],[624,"get_identity"],[633,"login_enable"],[691,"check_device_interfaces"],[715,"check_spoc_interfaces"],[745,"checkinterfaces"],[783,"sort_object_group"],[797,"equalize_obj_group"],[904,"check_object_group"],[924,"mark_object_group_from_acl"],[931,"mark_object_group_from_acl_entry"],[948,"acl_entry2key0"],[990,"acl_entry_abstract2key"],[995,"acl_entry2key"],[1003,"acl_entry_no_log2key"],[1018,"fix_transfer_groups"],[1046,"equalize_acl_groups"],[1095,"subst_ace_name_og"],[1123,"check_max_acl_entries"],[1154,"equalize_acl_entries"],[1320,"__ANON__"],[1382,"equalize_acl"]],"pod":[[170,"tcp_name2num"],[216,"udp_name2num"],[232,"analyze_conf_lines"],[415,"parse_address"],[433,"adjust_mask"],[438,"parse_port"],[470,"parse_port_spec"],[504,"parse_icmp_spec"],[519,"normalize_proto"],[530,"merge_acls"],[592,"enter_conf_mode"],[598,"leave_conf_mode"],[604,"check_conf_mode"],[609,"write_mem"],[614,"route_add"],[619,"route_del"],[624,"get_identity"],[633,"login_enable"],[691,"check_device_interfaces"],[715,"check_spoc_interfaces"],[745,"checkinterfaces"],[783,"sort_object_group"],[797,"equalize_obj_group"],[904,"check_object_group"],[924,"mark_object_group_from_acl"],[931,"mark_object_group_from_acl_entry"],[948,"acl_entry2key0"],[990,"acl_entry_abstract2key"],[995,"acl_entry2key"],[1003,"acl_entry_no_log2key"],[1018,"fix_transfer_groups"],[1046,"equalize_acl_groups"],[1095,"subst_ace_name_og"],[1123,"check_max_acl_entries"],[1154,"equalize_acl_entries"],[1382,"equalize_acl"]],"condition":[[279,{"left":"$parse_info","op":"and","right":"keys %$parse_info","type":"and_3"}],[294,{"op":"and","left":"$sub_level < $level","type":"and_3","right":"@stack"}],[300,{"op":"and","left":"$level + 1 == $sub_level","type":"and_3","right":"$rest eq 'quit'"}],[361,{"left":"$parse_info->{$lookup}","op":"||","right":"$parse_info->{'_any'}","type":"or_3"}],[378,{"right":"$cmd_info->{'strict'}","type":"or_3","left":"$strict","op":"||="}],[418,{"op":"or","left":"$token eq 'any'","type":"or_3","right":"$token eq 'any4'"}],[456,{"left":"$tcp","op":"and","right":"$udp","type":"and_3"}],[456,{"right":"$tcp == $udp","type":"and_3","left":"$tcp and $udp","op":"and"}],[513,{"right":"-1","type":"or_2","left":"check_regex('\\\\d+', $arg)","op":"||"}],[520,{"op":"||","left":"$IP_Names{$proto}","type":"or_3","right":"$proto"}],[553,{"op":"||=","left":"$spoc->{'ACCESS_LIST'}{$spoc_name}{'LIST'}","type":"or_2","right":"[]"}],[656,{"op":"||=","left":"$pass","type":"or_3","right":"$self->get_user_password($user)"}],[697,{"type":"or_3","right":"$conf_intf->{'UNNUMBERED'}","op":"or","left":"$conf_intf->{'ADDRESS'}"}],[723,{"op":"||","left":"$spoc_intf->{'VRF'}","type":"or_2","right":"'-'"}],[724,{"left":"$conf_intf->{'VRF'}","op":"||","right":"'-'","type":"or_2"}],[733,{"right":"$name =~ /^mpls/","type":"and_3","left":"$has_mpls","op":"and"}],[733,{"op":"and","left":"$has_mpls and $name =~ /^mpls/","type":"and_3","right":"$spoc_intf->{'UNNUMBERED'}"}],[830,{"type":"and_3","right":"$spoc_group->{'fixed'}","op":"and","left":"$spoc_group->{'transfer'}"}],[905,{"type":"and_3","right":"my $group = $attr->{'GROUP'}","op":"and","left":"ref $attr"}],[914,{"left":"$group->{'name_on_dev'} || $group->{'transfer'} && $group->{'new_name'}","op":"||","right":"$group->{'name'}","type":"or_3"}],[935,{"op":"&&","left":"ref $what","type":"and_3","right":"$what->{'GROUP'}"}],[961,{"type":"or_3","right":"\"$what->{'BASE'}/$what->{'MASK'}\"","op":"||","left":"check_object_group($what, $abstract)"}],[965,{"right":"$e->{'TYPE'}","type":"or_3","left":"check_object_group($e->{'TYPE'})","op":"||"}],[966,{"right":"$e->{'TYPE'} eq 'udp'","type":"or_3","left":"$e->{'TYPE'} eq 'tcp'","op":"or"}],[976,{"op":"||","left":"check_object_group($port)","type":"or_3","right":"\"$port->{'LOW'}:$port->{'HIGH'}\""}],[980,{"right":"!$ignore_log","type":"and_3","left":"$e->{'LOG'}","op":"&&"}],[1024,{"type":"and_3","right":"my $group = $what->{'GROUP'}","op":"and","left":"ref $what"}],[1065,{"left":"ref $what","op":"&&","right":"$what->{'GROUP'}","type":"and_3"}],[1067,{"op":"&&","left":"ref $what","type":"and_3","right":"$what->{'GROUP'}"}],[1103,{"op":"&&","left":"ref $what","type":"and_3","right":"$what->{'GROUP'}"}],[1106,{"type":"or_3","right":"$group->{'transfer'} && $group->{'new_name'}","op":"||","left":"$group->{'name_on_dev'}"}],[1126,{"right":"@$entries >= $incr","type":"and_3","left":"$incr > 1","op":"and"}],[1226,{"left":"$conf_entries->[$conf_next]","op":"||","right":"'LAST'","type":"or_2"}],[1238,{"type":"and_3","right":"$prev_entry","op":"and","left":"not $add_incr"}],[1251,{"right":"my $conf_entry = $dupl{$key}","type":"and_3","left":"not $spoc_entry->{'REMARK'}","op":"and"}],[1308,{"op":"or","left":"@add","type":"or_3","right":"@delete"}],[1383,{"type":"or_3","right":"$self->equalize_acl_entries($conf_acl, $spoc_acl)","op":"||","left":"$self->equalize_acl_groups($conf_acl, $spoc_acl)"}]],"start":{"609":{"write_mem":[{"statement":213,"subroutine":19,"pod":13,"condition":11,"branch":44,"time":null}]},"232":{"analyze_conf_lines":[{"subroutine":8,"pod":2,"condition":null,"statement":22,"branch":null,"time":null}]},"-1":{"__COVER__":[{"condition":37,"pod":36,"subroutine":43,"statement":555,"time":null,"branch":116}]},"1382":{"equalize_acl":[{"time":null,"branch":116,"condition":36,"pod":35,"subroutine":42,"statement":553}]},"1003":{"acl_entry_no_log2key":[{"time":null,"branch":87,"condition":26,"subroutine":35,"pod":29,"statement":400}]},"530":{"merge_acls":[{"time":null,"branch":38,"condition":10,"subroutine":15,"pod":9,"statement":174}]},"31":{"BEGIN":[{"statement":null,"subroutine":null,"pod":null,"condition":null,"branch":null,"time":null}]},"990":{"acl_entry_abstract2key":[{"time":null,"branch":87,"condition":26,"subroutine":33,"pod":27,"statement":396}]},"619":{"route_del":[{"branch":44,"time":null,"subroutine":21,"pod":15,"condition":11,"statement":217}]},"216":{"udp_name2num":[{"statement":20,"condition":null,"subroutine":7,"pod":1,"time":null,"branch":null}]},"598":{"leave_conf_mode":[{"time":null,"branch":44,"statement":208,"condition":11,"pod":11,"subroutine":17}]},"797":{"equalize_obj_group":[{"statement":294,"subroutine":28,"pod":22,"condition":17,"branch":61,"time":null}]},"415":{"parse_address":[{"time":null,"branch":21,"statement":117,"condition":5,"pod":3,"subroutine":9}]},"433":{"adjust_mask":[{"statement":127,"subroutine":10,"pod":4,"condition":6,"branch":23,"time":null}]},"604":{"check_conf_mode":[{"statement":211,"condition":11,"pod":12,"subroutine":18,"time":null,"branch":44}]},"783":{"sort_object_group":[{"time":null,"branch":61,"condition":17,"pod":21,"subroutine":27,"statement":286}]},"1095":{"subst_ace_name_og":[{"subroutine":38,"pod":32,"condition":29,"statement":445,"branch":98,"time":null}]},"438":{"parse_port":[{"condition":6,"subroutine":11,"pod":5,"statement":129,"time":null,"branch":23}]},"924":{"mark_object_group_from_acl":[{"statement":358,"condition":20,"pod":24,"subroutine":30,"time":null,"branch":74}]},"33":{"BEGIN":[{"pod":null,"subroutine":2,"condition":null,"statement":6,"branch":null,"time":null}]},"1154":{"equalize_acl_entries":[{"time":null,"branch":101,"statement":461,"condition":32,"subroutine":40,"pod":34}]},"1018":{"fix_transfer_groups":[{"time":null,"branch":87,"statement":402,"condition":26,"subroutine":36,"pod":30}]},"995":{"acl_entry2key":[{"condition":26,"subroutine":34,"pod":28,"statement":398,"time":null,"branch":87}]},"904":{"check_object_group":[{"pod":23,"subroutine":29,"condition":18,"statement":351,"branch":72,"time":null}]},"470":{"parse_port_spec":[{"branch":28,"time":null,"statement":142,"subroutine":12,"pod":6,"condition":8}]},"1046":{"equalize_acl_groups":[{"condition":27,"pod":31,"subroutine":37,"statement":419,"time":null,"branch":94}]},"715":{"check_spoc_interfaces":[{"condition":13,"pod":19,"subroutine":25,"statement":267,"time":null,"branch":56}]},"35":{"BEGIN":[{"time":null,"branch":null,"statement":12,"condition":null,"pod":null,"subroutine":4}]},"592":{"enter_conf_mode":[{"time":null,"branch":44,"statement":205,"condition":11,"subroutine":16,"pod":10}]},"948":{"acl_entry2key0":[{"statement":370,"condition":21,"pod":26,"subroutine":32,"time":null,"branch":77}]},"624":{"get_identity":[{"branch":44,"time":null,"subroutine":22,"pod":16,"condition":11,"statement":219}]},"170":{"tcp_name2num":[{"time":null,"branch":null,"statement":18,"condition":null,"subroutine":6,"pod":null}]},"504":{"parse_icmp_spec":[{"condition":8,"pod":7,"subroutine":13,"statement":159,"time":null,"branch":34}]},"691":{"check_device_interfaces":[{"condition":12,"pod":18,"subroutine":24,"statement":255,"time":null,"branch":50}]},"519":{"normalize_proto":[{"condition":9,"subroutine":14,"pod":8,"statement":169,"time":null,"branch":36}]},"633":{"login_enable":[{"time":null,"branch":44,"statement":223,"condition":11,"pod":17,"subroutine":23}]},"1320":{"__ANON__":[{"branch":116,"time":null,"pod":35,"subroutine":41,"condition":36,"statement":553}]},"36":{"BEGIN":[{"condition":null,"pod":null,"subroutine":5,"statement":15,"time":null,"branch":null}]},"931":{"mark_object_group_from_acl_entry":[{"time":null,"branch":74,"statement":362,"condition":20,"subroutine":31,"pod":25}]},"745":{"checkinterfaces":[{"branch":60,"time":null,"statement":281,"subroutine":26,"pod":20,"condition":17}]},"32":{"BEGIN":[{"branch":null,"time":null,"pod":null,"subroutine":1,"condition":null,"statement":3}]},"1123":{"check_max_acl_entries":[{"condition":31,"subroutine":39,"pod":33,"statement":456,"time":null,"branch":100}]},"34":{"BEGIN":[{"pod":null,"subroutine":3,"condition":null,"statement":9,"branch":null,"time":null}]},"614":{"route_add":[{"branch":44,"time":null,"statement":215,"pod":14,"subroutine":20,"condition":11}]}},"file":"lib/Netspoc/Approve/Cisco.pm","statement":[31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,170,171,216,217,232,233,234,235,236,237,238,239,240,242,243,245,246,247,250,250,252,256,259,262,263,265,274,279,280,281,282,284,287,288,294,295,295,299,300,304,305,311,312,313,314,321,322,323,324,325,326,327,328,329,330,331,332,333,334,337,338,339,340,343,344,349,351,352,354,355,356,358,359,361,366,372,373,374,375,376,377,378,379,380,383,384,392,393,394,395,396,397,398,399,400,404,405,405,407,415,416,417,418,419,422,423,426,427,429,433,434,438,439,442,445,446,449,454,455,456,457,460,463,464,470,471,472,474,475,476,477,480,481,482,485,486,487,490,493,494,496,504,505,506,507,508,509,509,512,513,515,519,520,521,523,526,530,532,532,533,534,536,537,539,543,544,545,546,548,551,553,554,555,556,559,560,561,562,565,568,571,572,574,575,580,583,584,592,593,594,598,599,600,604,605,609,610,614,615,619,620,624,625,628,629,633,634,639,641,642,643,644,645,648,649,650,651,652,654,655,656,657,658,660,661,664,665,666,670,672,673,677,682,683,684,685,686,691,693,694,694,695,696,697,698,701,702,703,709,715,717,718,718,719,720,723,724,725,733,734,735,738,741,745,751,751,752,755,783,784,785,786,789,787,788,789,797,805,807,808,810,813,822,823,824,825,827,830,831,832,835,836,837,838,840,846,847,848,849,850,854,855,856,857,858,863,864,865,866,867,868,870,872,873,878,879,880,881,885,886,887,888,889,890,890,891,891,893,894,895,896,898,900,904,905,906,907,914,915,919,924,925,925,926,931,932,933,934,935,936,937,938,948,950,951,953,954,957,958,959,960,961,965,966,967,968,969,970,974,975,976,978,980,981,982,983,984,986,990,991,995,996,1003,1004,1018,1019,1020,1021,1022,1023,1024,1025,1026,1030,1032,1033,1033,1035,1036,1037,1038,1046,1047,1048,1049,1050,1052,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1070,1073,1082,1086,1087,1091,1095,1096,1099,1101,1102,1103,1104,1106,1113,1118,1119,1123,1124,1125,1126,1127,1154,1155,1156,1157,1159,1164,1171,1175,1178,1183,1186,1189,1194,1196,1200,1201,1203,1206,1207,1208,1210,1211,1212,1214,1216,1222,1223,1224,1225,1226,1227,1228,1229,1233,1238,1241,1243,1244,1249,1250,1251,1256,1257,1258,1260,1263,1267,1270,1271,1272,1284,1300,1302,1308,1310,1311,1314,1331,1320,1322,1323,1324,1326,1328,1330,1334,1335,1336,1337,1338,1340,1342,1343,1344,1345,1346,1347,1354,1355,1356,1357,1359,1360,1361,1362,1363,1364,1365,1366,1368,1372,1373,1382,1383],"branch":[[246,{"text":"if ($line =~ /$end_banner_regex/) { }"}],[245,{"text":"if (my $cmd = $in_banner)"}],[256,{"text":"if $line =~ /^ *!/"}],[259,{"text":"if $line =~ /^\\s*$/"}],[279,{"text":"unless ($parse_info and keys %$parse_info)"}],[274,{"text":"if ($first_subcmd) { }"}],[300,{"text":"if ($level + 1 == $sub_level and $rest eq 'quit') { }"}],[299,{"text":"if ($sub_level != $level)"}],[265,{"text":"if ($sub_level == $level) { }"}],[265,{"text":"elsif ($sub_level > $level) { }"}],[330,{"text":"if ($next = $prefix_info->{$prefix}) { }"}],[330,{"text":"elsif ($next = $prefix_info->{'_any'}) { }"}],[330,{"text":"elsif ($next = $prefix_info->{'_skip'}) { }"}],[351,{"text":"unless keys %$next"}],[321,{"text":"if (my $prefix_info = $parse_info->{'_prefix'})"}],[358,{"text":"unless ($lookup)"}],[373,{"text":"if (my $subcmd = $cmd_info->{'subcmd'}) { }"}],[373,{"text":"elsif ($end_banner_regex = $cmd_info->{'banner'}) { }"}],[399,{"text":"if $strict eq 'err'"}],[397,{"text":"if ($strict)"}],[361,{"text":"if (my $cmd_info = $parse_info->{$lookup} || $parse_info->{'_any'}) { }"}],[418,{"text":"if ($token eq 'any' or $token eq 'any4') { }"}],[418,{"text":"elsif ($token eq 'host') { }"}],[442,{"text":"if $port =~ /^\\d+$/"}],[456,{"text":"if ($tcp and $udp and $tcp == $udp) { }"}],[445,{"text":"if ($proto eq 'tcp') { }"}],[445,{"text":"elsif ($proto eq 'udp') { }"}],[463,{"text":"unless defined $port"}],[472,{"text":"unless my $spec = check_regex('eq|gt|lt|neq|range', $arg)"}],[475,{"text":"if ($spec eq 'eq') { }"}],[475,{"text":"elsif ($spec eq 'gt') { }"}],[475,{"text":"elsif ($spec eq 'lt') { }"}],[475,{"text":"elsif ($spec eq 'neq') { }"}],[475,{"text":"elsif ($spec eq 'range') { }"}],[507,{"text":"unless defined $token"}],[508,{"text":"if (my $spec = $ICMP_Names{$token}) { }"}],[521,{"text":"unless $proto =~ /^(?:\\d+|icmp|tcp|udp)$/"}],[523,{"text":"if $proto =~ /^(1|6|17)$/"}],[536,{"text":"unless ($spoc_intf)"}],[561,{"text":"if ($$spoc_entries[$index - 1]{'MODE'} eq 'deny') { }"}],[555,{"text":"if ($append) { }"}],[580,{"text":"if $spoc->{'ACCESS_LIST'}{$raw_name}"}],[548,{"text":"if (my $spoc_name = $spoc_intf->{$access_group}) { }"}],[545,{"text":"if (my $raw_name = $raw_intf->{$access_group})"}],[644,{"text":"if ($result->{'ERROR'})"}],[649,{"text":"if ($match =~ m[\\(yes/no\\)\\?]i)"}],[666,{"text":"if ($con->{'RESULT'}{'MATCH'} ne '#')"}],[672,{"text":"if ($con->{'RESULT'}{'MATCH'} ne '#')"}],[661,{"text":"if ($match eq '>') { }"}],[661,{"text":"elsif ($match ne '#') { }"}],[696,{"text":"if $conf_intf->{'SHUTDOWN'}"}],[697,{"text":"unless $conf_intf->{'ADDRESS'} or $conf_intf->{'UNNUMBERED'}"}],[701,{"text":"$conf_intf->{'INSPECT'} ? :"}],[702,{"text":"$spoc_intf->{'INSPECT'} ? :"}],[703,{"text":"unless $conf_inspect eq $spoc_inspect"}],[698,{"text":"if (my $spoc_intf = $spoc->{'IF'}{$name}) { }"}],[725,{"text":"unless $conf_vrf eq $spoc_vrf"}],[733,{"text":"if ($has_mpls and $name =~ /^mpls/ and $spoc_intf->{'UNNUMBERED'})"}],[720,{"text":"if (my $conf_intf = $conf->{'IF'}{$name}) { }"}],[741,{"text":"if @errors"}],[751,{"text":"if (grep {/^(?:ACCESS_LIST|CRYPTO)/;} keys %$spoc)"}],[807,{"text":"if ($conf_group->{'name'} ne $other_conf_group_name) { }"}],[805,{"text":"if (my $other_conf_group_name = $spoc_group->{'name_on_dev'})"}],[822,{"text":"if (my $other_spoc_group = $conf_group->{'needed'})"}],[830,{"text":"if ($spoc_group->{'transfer'} and $spoc_group->{'fixed'})"}],[835,{"text":"if ($conf_group->{'TYPE'} ne $spoc_group->{'TYPE'})"}],[856,{"text":"if ($diff->Diff)"}],[867,{"text":"if ($spoc_group->{'transfer'})"}],[863,{"text":"if (not $change_lines) { }"}],[863,{"text":"elsif ($change_lines >= @$spoc_networks) { }"}],[889,{"text":"if $diff->Same"}],[895,{"text":"if ($spoc_group->{'transfer'})"}],[906,{"text":"if ($abstract) { }"}],[905,{"text":"if (ref $attr and my $group = $attr->{'GROUP'}) { }"}],[932,{"text":"if $acl_entry->{'REMARK'}"}],[936,{"text":"unless ($group->{'name_on_dev'})"}],[935,{"text":"if (my $group = ref $what && $what->{'GROUP'})"}],[950,{"text":"if (my $string = $e->{'REMARK'})"}],[953,{"text":"if ($e->{'UNKNOWN'})"}],[970,{"text":"defined $v ? :"}],[978,{"text":"if $e->{'ESTA'}"}],[966,{"text":"if ($e->{'TYPE'} eq 'icmp') { }"}],[966,{"text":"elsif ($e->{'TYPE'} eq 'tcp' or $e->{'TYPE'} eq 'udp') { }"}],[982,{"text":"if $e->{'LOG_MODE'}"}],[983,{"text":"if $e->{'LOG_LEVEL'}"}],[984,{"text":"if $e->{'LOG_INTERVAL'}"}],[980,{"text":"if (my $log = $e->{'LOG'} && !$ignore_log)"}],[1019,{"text":"unless keys %$dupl"}],[1020,{"text":"if $entry->{'REMARK'}"}],[1025,{"text":"if ($group->{'transfer'})"}],[1024,{"text":"if (ref $what and my $group = $what->{'GROUP'})"}],[1030,{"text":"unless @need_fix"}],[1032,{"text":"unless (keys %$abstract)"}],[1036,{"text":"unless $abstract->{$key}"}],[1061,{"text":"if $conf_entry->{'REMARK'}"}],[1068,{"text":"if ($self->equalize_obj_group($conf_group, $spoc_group)) { }"}],[1065,{"text":"if (my $conf_group = ref $what && $what->{'GROUP'})"}],[1055,{"text":"if ($diff->Same) { }"}],[1106,{"text":"unless my $new_gid = $group->{'name_on_dev'} || $group->{'transfer'} && $group->{'new_name'}"}],[1103,{"text":"if (my $group = ref $what && $what->{'GROUP'})"}],[1126,{"text":"if ($incr > 1 and @$entries >= $incr)"}],[1212,{"text":"if $dupl{$key}"}],[1210,{"text":"unless ($conf_entry->{'REMARK'})"}],[1207,{"text":"if ($diff->Diff & 1)"}],[1238,{"text":"if not $add_incr and $prev_entry"}],[1256,{"text":"if ($self->is_device_access($conf_entry))"}],[1267,{"text":"if ($device_line{$next_conf_entry} < $device_line{$conf_entry}) { }"}],[1251,{"text":"if (not $spoc_entry->{'REMARK'} and my $conf_entry = $dupl{$key}) { }"}],[1224,{"text":"if ($diff->Diff & 2)"}],[1308,{"text":"unless @add or @delete"}],[1324,{"text":"if ($line = $device_line{$next_entry})"}],[1336,{"text":"if (my $conf_entry = $move_up{$spoc_entry})"}],[1347,{"text":"$vcmd1 ? :"}],[1355,{"text":"if $moved{$conf_entry}"}],[1361,{"text":"if (my $spoc_entry = $move_down{$conf_entry})"}],[1368,{"text":"$vcmd2 ? :"}]]}