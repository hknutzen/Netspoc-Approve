{"subroutine":[[29,"BEGIN"],[30,"BEGIN"],[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[34,"BEGIN"],[35,"BEGIN"],[50,"get_parse_info"],[150,"analyze_conf_lines"],[225,"parse_policy"],[237,"parse_rule"],[283,"postprocess_iptables"],[359,"normalize"],[395,"merge_acls"],[450,"postprocess_routes"],[469,"postprocess_config"],[476,"value_differ"],[498,"hash_differ"],[514,"array_differ"],[530,"compare_iptables"],[551,"status_ok"],[557,"cmd_ok"],[569,"cmd_check_error"],[583,"enter_conf_mode"],[588,"leave_conf_mode"],[593,"route_add"],[598,"route_del"],[605,"do_scp"],[622,"write_startup_routing"],[640,"find_iptables_restore_cmd"],[650,"get_iptables_config"],[678,"write_startup_iptables"],[689,"transfer"],[717,"write_mem"],[747,"get_config_from_device"],[755,"get_identity"],[760,"parse_version"],[766,"set_terminal"],[770,"search_banner"],[775,"login_enable"]],"digest":"a88562ce0d7a7f421f5bd737dc262d21","pod":[[50,"get_parse_info"],[150,"analyze_conf_lines"],[225,"parse_policy"],[237,"parse_rule"],[283,"postprocess_iptables"],[359,"normalize"],[395,"merge_acls"],[450,"postprocess_routes"],[469,"postprocess_config"],[476,"value_differ"],[498,"hash_differ"],[514,"array_differ"],[530,"compare_iptables"],[551,"status_ok"],[557,"cmd_ok"],[569,"cmd_check_error"],[583,"enter_conf_mode"],[588,"leave_conf_mode"],[593,"route_add"],[598,"route_del"],[605,"do_scp"],[622,"write_startup_routing"],[640,"find_iptables_restore_cmd"],[650,"get_iptables_config"],[678,"write_startup_iptables"],[689,"transfer"],[717,"write_mem"],[747,"get_config_from_device"],[755,"get_identity"],[760,"parse_version"],[766,"set_terminal"],[770,"search_banner"],[775,"login_enable"]],"condition":[[177,{"left":"$prefix_info = $prefix_info->{$prefix}","op":"and","right":"keys %$prefix_info","type":"and_3"}],[193,{"right":"@stack","type":"and_3","left":"not $parse_info->{$cmd}","op":"and"}],[249,{"type":"or_3","right":"$key","op":"||=","left":"$negate"}],[253,{"op":"||","left":"check_regex(qr/!/, $arg)","type":"or_2","right":"''"}],[261,{"op":"||=","left":"$negate","type":"or_3","right":"$negate_arg"}],[267,{"op":"and","left":"$key eq '--tcp-flags'","type":"and_2","right":"$v = '!FIN,SYN,RST,ACK SYN'"}],[367,{"type":"or_2","right":"''","op":"||","left":"$rule->{'-p'}"}],[376,{"type":"or_3","right":"$v =~ m[/0xffffffff$]i","op":"or","left":"not $v =~ m[/]"}],[423,{"type":"or_2","right":"[]","op":"||=","left":"$spoc_chain->{'RULES'}"}],[458,{"left":"$entry->{'SCOPE'}","op":"and","right":"$entry->{'SCOPE'} eq 'link'","type":"and_3"}],[459,{"right":"$entry->{'PROTO'} ne 'static'","type":"and_3","left":"$entry->{'PROTO'}","op":"and"}],[477,{"op":"||","left":"ref $conf","type":"or_3","right":"ref $spoc"}],[486,{"op":"||=","left":"$conf","type":"or_2","right":"''"}],[487,{"type":"or_2","right":"''","op":"||=","left":"$spoc"}],[501,{"left":"$c_extra","op":"or","right":"$s_extra","type":"or_3"}],[553,{"op":"&&","left":"@$status == 1","type":"and_3","right":"$status->[0] eq '0'"}],[572,{"left":"@$lines == 1 && $valid","op":"&&","right":"$lines->[0] eq $valid","type":"and_3"}],[661,{"left":"$chain->{'POLICY'}","op":"||","right":"'-'","type":"or_2"}],[738,{"op":"and","left":"my $cmd = $config->{'store_flash_cmd'}","type":"and_3","right":"$self->cmd_ok('ls /etc/router-version')"}]],"start":{"237":{"parse_rule":[{"branch":7,"time":null,"statement":64,"pod":3,"subroutine":10,"condition":2}]},"598":{"route_del":[{"statement":226,"pod":19,"subroutine":26,"condition":17,"branch":41,"time":null}]},"775":{"login_enable":[{"condition":19,"subroutine":39,"pod":32,"statement":324,"time":null,"branch":57}]},"-1":{"__COVER__":[{"subroutine":40,"pod":33,"condition":19,"statement":345,"branch":61,"time":null}]},"755":{"get_identity":[{"condition":19,"subroutine":35,"pod":28,"statement":316,"time":null,"branch":57}]},"557":{"cmd_ok":[{"branch":38,"time":null,"pod":14,"subroutine":21,"condition":16,"statement":213}]},"31":{"BEGIN":[{"condition":null,"pod":null,"subroutine":2,"statement":6,"time":null,"branch":null}]},"678":{"write_startup_iptables":[{"branch":49,"time":null,"statement":277,"subroutine":31,"pod":24,"condition":18}]},"530":{"compare_iptables":[{"statement":200,"condition":15,"pod":12,"subroutine":19,"time":null,"branch":36}]},"35":{"BEGIN":[{"pod":null,"subroutine":6,"condition":null,"statement":18,"branch":null,"time":null}]},"476":{"value_differ":[{"branch":28,"time":null,"subroutine":16,"pod":9,"condition":11,"statement":169}]},"605":{"do_scp":[{"branch":41,"time":null,"subroutine":27,"pod":20,"condition":17,"statement":230}]},"569":{"cmd_check_error":[{"statement":216,"subroutine":22,"pod":15,"condition":16,"branch":38,"time":null}]},"498":{"hash_differ":[{"statement":179,"pod":10,"subroutine":17,"condition":14,"branch":31,"time":null}]},"640":{"find_iptables_restore_cmd":[{"statement":250,"subroutine":29,"pod":22,"condition":17,"branch":47,"time":null}]},"588":{"leave_conf_mode":[{"condition":17,"pod":17,"subroutine":24,"statement":223,"time":null,"branch":41}]},"33":{"BEGIN":[{"time":null,"branch":null,"statement":12,"condition":null,"subroutine":4,"pod":null}]},"593":{"route_add":[{"branch":41,"time":null,"subroutine":25,"pod":18,"condition":17,"statement":224}]},"766":{"set_terminal":[{"time":null,"branch":57,"condition":19,"pod":30,"subroutine":37,"statement":321}]},"450":{"postprocess_routes":[{"time":null,"branch":24,"statement":154,"condition":9,"pod":7,"subroutine":14}]},"689":{"transfer":[{"statement":284,"condition":18,"subroutine":32,"pod":25,"time":null,"branch":51}]},"622":{"write_startup_routing":[{"subroutine":28,"pod":21,"condition":17,"statement":238,"branch":45,"time":null}]},"359":{"normalize":[{"statement":101,"condition":6,"pod":5,"subroutine":12,"time":null,"branch":13}]},"717":{"write_mem":[{"condition":18,"pod":26,"subroutine":33,"statement":297,"time":null,"branch":54}]},"29":{"BEGIN":[{"time":null,"branch":null,"condition":null,"pod":null,"subroutine":null,"statement":null}]},"30":{"BEGIN":[{"statement":3,"condition":null,"subroutine":1,"pod":null,"time":null,"branch":null}]},"283":{"postprocess_iptables":[{"statement":87,"subroutine":11,"pod":4,"condition":6,"branch":11,"time":null}]},"514":{"array_differ":[{"statement":191,"subroutine":18,"pod":11,"condition":15,"branch":34,"time":null}]},"150":{"analyze_conf_lines":[{"statement":24,"pod":1,"subroutine":8,"condition":null,"branch":null,"time":null}]},"225":{"parse_policy":[{"branch":6,"time":null,"subroutine":9,"pod":2,"condition":2,"statement":60}]},"32":{"BEGIN":[{"time":null,"branch":null,"statement":9,"condition":null,"pod":null,"subroutine":3}]},"770":{"search_banner":[{"branch":57,"time":null,"pod":31,"subroutine":38,"condition":19,"statement":322}]},"469":{"postprocess_config":[{"time":null,"branch":28,"condition":11,"pod":8,"subroutine":15,"statement":165}]},"50":{"get_parse_info":[{"condition":null,"subroutine":7,"pod":null,"statement":21,"time":null,"branch":null}]},"551":{"status_ok":[{"statement":210,"pod":13,"subroutine":20,"condition":15,"branch":38,"time":null}]},"34":{"BEGIN":[{"time":null,"branch":null,"condition":null,"pod":null,"subroutine":5,"statement":15}]},"747":{"get_config_from_device":[{"condition":19,"subroutine":34,"pod":27,"statement":311,"time":null,"branch":57}]},"760":{"parse_version":[{"branch":57,"time":null,"pod":29,"subroutine":36,"condition":19,"statement":318}]},"650":{"get_iptables_config":[{"statement":255,"condition":17,"pod":23,"subroutine":30,"time":null,"branch":49}]},"583":{"enter_conf_mode":[{"statement":222,"condition":17,"pod":16,"subroutine":23,"time":null,"branch":41}]},"395":{"merge_acls":[{"branch":19,"time":null,"pod":6,"subroutine":13,"condition":8,"statement":121}]}},"file":"lib/Netspoc/Approve/Linux.pm","statement":[29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,50,51,136,150,151,152,153,154,156,157,160,163,165,168,171,172,174,175,176,177,180,181,187,193,194,194,198,199,200,201,202,203,204,205,211,214,215,215,217,225,226,229,232,237,243,244,245,246,247,248,249,250,252,253,254,255,257,258,261,263,267,268,269,271,273,274,283,285,288,289,290,291,292,293,294,295,297,298,301,303,359,360,361,362,363,363,366,367,368,369,375,376,377,378,382,383,384,385,386,387,395,396,397,398,402,403,404,405,406,407,409,410,411,412,413,414,415,417,418,422,423,424,425,426,429,430,431,432,435,438,441,442,444,450,451,456,457,457,458,459,460,461,463,465,469,470,471,472,476,477,478,479,482,486,487,488,489,492,498,499,499,500,500,501,502,504,505,506,507,510,514,515,516,517,518,520,521,522,525,530,531,532,533,534,537,541,542,543,546,551,552,553,557,560,561,569,570,571,572,573,577,583,588,593,594,598,599,600,601,605,606,607,608,609,615,616,617,622,623,627,628,629,630,630,631,632,633,635,636,640,641,642,644,646,650,651,652,653,654,655,656,657,658,659,660,661,662,664,665,666,666,667,668,669,672,674,678,679,680,682,683,684,685,689,692,695,697,700,701,702,707,708,709,710,711,712,717,720,721,722,725,726,730,731,732,733,734,738,741,742,747,749,750,751,751,755,756,760,761,762,766,770,771,775,776,777,778,779,780,781,783,784,785,786,790,791,792,793,794,795,798,804,805,806],"branch":[[160,{"text":"if $line =~ /^\\s*#/"}],[163,{"text":"if $line =~ /^\\s*$/"}],[171,{"text":"if ($args[0] =~ /^([*:])(.*)$/)"}],[175,{"text":"if (my $prefix_info = $parse_info->{'_prefix'})"}],[201,{"text":"if (my $subcmd = $parse_info->{$cmd}{'subcmd'})"}],[198,{"text":"if (my $cmd_info = $parse_info->{$cmd}) { }"}],[232,{"text":"$policy eq '-' ? :"}],[248,{"text":"if ($key eq '!')"}],[257,{"text":"if (not @args) { }"}],[267,{"text":"if ($key eq '--tcp-flags' and $v = '!FIN,SYN,RST,ACK SYN')"}],[273,{"text":"if $negate_next_cmd"}],[294,{"text":"if $policies->{$name}"}],[298,{"text":"if $new->{$name}"}],[368,{"text":"if (lc $v eq lc $proto)"}],[366,{"text":"if (my $v = $rule->{'-m'})"}],[376,{"text":"if (not $v =~ m[/] or $v =~ m[/0xffffffff$]i)"}],[375,{"text":"if (my $v = $rule->{'--set-xmark'})"}],[383,{"text":"unless $key =~ /^-/"}],[385,{"text":"unless my $fun = $normalize{$key}"}],[404,{"text":"unless ($spoc_chains)"}],[412,{"text":"unless ($spoc_chain)"}],[417,{"text":"unless ($spoc_chain->{'POLICY'})"}],[431,{"text":"if ($$spoc_entries[$index - 1]{-'j'} =~ /^drop/i) { }"}],[425,{"text":"if ($append) { }"}],[451,{"text":"unless $config->{'ROUTING'}"}],[458,{"text":"if $entry->{'SCOPE'} and $entry->{'SCOPE'} eq 'link'"}],[459,{"text":"if $entry->{'PROTO'} and $entry->{'PROTO'} ne 'static'"}],[460,{"text":"if ($entry->{'NEXTHOP'})"}],[478,{"text":"if ($type eq 'HASH') { }"}],[488,{"text":"if ($conf eq $spoc) { }"}],[477,{"text":"if (my $type = ref $conf || ref $spoc) { }"}],[501,{"text":"if ($c_extra or $s_extra)"}],[505,{"text":"if $key =~ /(?:name|line|orig)/"}],[506,{"text":"if (my $diff = value_differ($conf->{$key}, $spoc->{$key}))"}],[515,{"text":"if (@$conf != @$spoc)"}],[521,{"text":"if (my $diff = value_differ($conf->[$i], $spoc->[$i]))"}],[532,{"text":"unless my $diff = value_differ($conf->{'IPTABLES'}, $spoc->{'IPTABLES'})"}],[537,{"text":"if ($self->{'COMPARE'}) { }"}],[572,{"text":"if (not @$lines == 1 && $valid && $lines->[0] eq $valid)"}],[570,{"text":"if (@$lines) { }"}],[570,{"text":"elsif (not $self->status_ok) { }"}],[606,{"text":"if $ENV{'SIMULATE_ROUTER'}"}],[609,{"text":"$mode eq 'get' ? :"}],[609,{"text":"$mode eq 'put' ? :"}],[617,{"text":"unless system(@args) == 0"}],[627,{"text":"unless my($fh, $tmpname) = tempfile('UNLINK', 1)"}],[635,{"text":"unless close $fh"}],[641,{"text":"if ($self->{'COMPARE'})"}],[644,{"text":"unless my $path = $self->get_cmd_output('which iptables-restore')->[0]"}],[680,{"text":"unless my($fh, $tmpname) = tempfile('UNLINK', 1)"}],[684,{"text":"unless close $fh"}],[697,{"text":"if $self->{'COMPARE'}"}],[700,{"text":"if ($self->{'CHANGE'}{'ROUTING'})"}],[707,{"text":"if ($self->{'CHANGE'}{'ACL'})"}],[722,{"text":"if ($self->{'CHANGE'}{'ROUTING'})"}],[732,{"text":"if ($self->{'CHANGE'}{'ACL'})"}],[738,{"text":"if (my $cmd = $config->{'store_flash_cmd'} and $self->cmd_ok('ls /etc/router-version'))"}],[780,{"text":"if ($result->{'ERROR'})"}],[783,{"text":"if ($con->{'RESULT'}{'MATCH'} =~ qr\"\\(yes/no\\)\\?\"i)"}],[794,{"text":"unless ($con->{'RESULT'}{'MATCH'} =~ /$std_prompt/)"}],[790,{"text":"if ($con->{'RESULT'}{'MATCH'} =~ qr/password:/i)"}]]}