{"condition":[[279,{"left":"$parse_info","right":"keys %$parse_info","type":"and_3","op":"and"}],[293,{"left":"$sub_level < $level","right":"@stack","type":"and_3","op":"and"}],[299,{"left":"$level + 1 == $sub_level","op":"and","type":"and_3","right":"$rest eq 'quit'"}],[359,{"right":"$parse_info->{'_any'}","type":"or_3","op":"||","left":"$parse_info->{$lookup}"}],[376,{"op":"||=","type":"or_3","right":"$cmd_info->{'strict'}","left":"$strict"}],[416,{"left":"$token eq 'any'","op":"or","right":"$token eq 'any4'","type":"or_3"}],[454,{"left":"$tcp","right":"$udp","type":"and_3","op":"and"}],[454,{"left":"$tcp and $udp","op":"and","type":"and_3","right":"$tcp == $udp"}],[514,{"left":"check_regex('\\\\d+', $arg)","op":"||","type":"or_2","right":"-1"}],[521,{"left":"$IP_Names{$proto}","right":"$proto","type":"or_3","op":"||"}],[554,{"type":"or_2","right":"[]","op":"||=","left":"$spoc->{'ACCESS_LIST'}{$spoc_name}{'LIST'}"}],[681,{"op":"||=","right":"$self->get_user_password($user)","type":"or_3","left":"$pass"}],[687,{"op":"or","right":"$try_telnet","type":"or_3","left":"not $user"}],[706,{"type":"or_2","right":"'device'","op":"||","left":"$user"}],[706,{"op":"||=","right":"$self->get_user_password($user || 'device')","type":"or_3","left":"$pass"}],[720,{"right":"$pass","type":"or_3","op":"||","left":"$self->{'ENABLE_PASS'}"}],[755,{"left":"$conf_intf->{'ADDRESS'}","right":"$conf_intf->{'UNNUMBERED'}","type":"or_3","op":"or"}],[759,{"left":"$conf_intf->{'VRF'}","op":"||","right":"'-'","type":"or_2"}],[760,{"op":"||","type":"or_2","right":"'-'","left":"$spoc_intf->{'VRF'}"}],[782,{"op":"and","right":"$name =~ /^mpls/","type":"and_3","left":"$has_mpls"}],[867,{"op":"and","type":"and_3","right":"$spoc_group->{'fixed'}","left":"$spoc_group->{'transfer'}"}],[942,{"left":"ref $attr","op":"and","right":"my $group = $attr->{'GROUP'}","type":"and_3"}],[951,{"op":"||","right":"$group->{'name'}","type":"or_3","left":"$group->{'name_on_dev'} || $group->{'transfer'} && $group->{'new_name'}"}],[972,{"left":"ref $what","op":"&&","type":"and_3","right":"$what->{'GROUP'}"}],[995,{"right":"\"$what->{'BASE'}/$what->{'MASK'}\"","type":"or_3","op":"||","left":"check_object_group($what, $abstract)"}],[999,{"left":"check_object_group($e->{'TYPE'})","op":"||","type":"or_3","right":"$e->{'TYPE'}"}],[1000,{"left":"$e->{'TYPE'} eq 'tcp'","op":"or","type":"or_3","right":"$e->{'TYPE'} eq 'udp'"}],[1010,{"left":"check_object_group($port)","op":"||","right":"\"$port->{'LOW'}:$port->{'HIGH'}\"","type":"or_3"}],[1014,{"left":"$e->{'LOG'}","right":"!$ignore_log","type":"and_3","op":"&&"}],[1058,{"type":"and_3","right":"my $group = $what->{'GROUP'}","op":"and","left":"ref $what"}],[1099,{"left":"ref $what","right":"$what->{'GROUP'}","type":"and_3","op":"&&"}],[1101,{"left":"ref $what","op":"&&","right":"$what->{'GROUP'}","type":"and_3"}],[1137,{"op":"&&","type":"and_3","right":"$what->{'GROUP'}","left":"ref $what"}],[1140,{"left":"$group->{'name_on_dev'}","type":"or_3","right":"$group->{'transfer'} && $group->{'new_name'}","op":"||"}],[1160,{"op":"and","right":"@$entries >= $incr","type":"and_3","left":"$incr > 1"}],[1260,{"left":"$conf_entries->[$conf_next]","type":"or_2","right":"'LAST'","op":"||"}],[1272,{"left":"not $add_incr","op":"and","right":"$prev_entry","type":"and_3"}],[1285,{"right":"my $conf_entry = $dupl{$key}","type":"and_3","op":"and","left":"not $spoc_entry->{'REMARK'}"}],[1342,{"left":"@add","right":"@delete","type":"or_3","op":"or"}],[1423,{"type":"or_3","right":"$self->equalize_acl_entries($conf_acl, $spoc_acl)","op":"||","left":"$self->equalize_acl_groups($conf_acl, $spoc_acl)"}]],"statement":[31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,170,171,216,217,232,233,234,235,236,237,238,239,240,242,243,245,246,247,250,250,252,256,259,262,263,265,274,279,280,281,282,284,287,293,294,294,298,299,303,309,310,311,312,319,320,321,322,323,324,325,326,327,328,329,330,331,332,335,336,337,338,341,342,347,349,350,352,353,354,356,357,359,364,370,371,372,373,374,375,376,377,378,381,382,390,391,392,393,394,395,396,397,398,402,403,403,405,413,414,415,416,417,420,421,424,425,427,431,432,436,437,440,443,444,447,452,453,454,455,458,461,462,468,469,470,472,473,474,475,478,479,480,483,484,485,488,491,492,495,497,505,506,507,508,509,510,510,513,514,516,520,521,522,524,527,531,533,533,534,535,537,538,540,544,545,546,547,549,552,554,555,556,557,560,561,562,563,566,569,572,573,575,576,581,584,585,593,594,595,599,600,601,605,606,610,611,615,616,620,621,625,626,629,630,634,635,636,636,640,643,644,649,651,654,655,656,658,659,660,661,664,665,666,669,673,674,675,676,677,679,680,681,682,683,687,688,689,691,692,693,694,696,697,698,699,701,703,705,706,707,711,712,715,716,717,720,721,723,724,728,733,734,735,736,737,742,747,747,748,751,752,752,753,754,755,756,759,760,761,767,768,769,775,778,778,779,782,783,784,785,786,790,792,820,821,822,823,826,824,825,826,834,842,844,845,847,850,859,860,861,862,864,867,868,869,872,873,874,875,877,883,884,885,886,887,891,892,893,894,895,900,901,902,903,904,905,907,909,910,915,916,917,918,922,923,924,925,926,927,927,928,928,930,931,932,933,935,937,941,942,943,944,951,952,956,961,962,962,963,968,969,970,971,972,973,974,975,985,987,988,991,992,993,994,995,999,1000,1001,1002,1003,1004,1008,1009,1010,1012,1014,1015,1016,1017,1018,1020,1024,1025,1029,1030,1037,1038,1052,1053,1054,1055,1056,1057,1058,1059,1060,1064,1066,1067,1067,1069,1070,1071,1072,1080,1081,1082,1083,1084,1086,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1104,1107,1116,1120,1121,1125,1129,1130,1133,1135,1136,1137,1138,1140,1147,1152,1153,1157,1158,1159,1160,1161,1188,1189,1190,1191,1193,1198,1205,1209,1212,1217,1220,1223,1228,1230,1234,1235,1237,1240,1241,1242,1244,1245,1246,1248,1250,1256,1257,1258,1259,1260,1261,1262,1263,1267,1272,1275,1277,1278,1283,1284,1285,1290,1291,1292,1294,1297,1301,1304,1305,1306,1318,1334,1336,1342,1344,1345,1348,1365,1354,1356,1357,1358,1360,1362,1364,1368,1369,1370,1371,1372,1374,1376,1377,1378,1379,1380,1381,1388,1389,1390,1391,1393,1394,1395,1396,1397,1398,1399,1400,1402,1405,1408,1409,1412,1422,1423],"file":"lib/Netspoc/Approve/Cisco.pm","digest":"3ab75e5124213533e97929dc241ac169","subroutine":[[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[34,"BEGIN"],[35,"BEGIN"],[36,"BEGIN"],[170,"tcp_name2num"],[216,"udp_name2num"],[232,"analyze_conf_lines"],[413,"parse_address"],[431,"adjust_mask"],[436,"parse_port"],[468,"parse_port_spec"],[505,"parse_icmp_spec"],[520,"normalize_proto"],[531,"merge_acls"],[593,"enter_conf_mode"],[599,"leave_conf_mode"],[605,"check_conf_mode"],[610,"write_mem"],[615,"route_add"],[620,"route_del"],[625,"get_identity"],[634,"login_enable"],[742,"checkinterfaces"],[820,"sort_object_group"],[834,"equalize_obj_group"],[941,"check_object_group"],[961,"mark_object_group_from_acl"],[968,"mark_object_group_from_acl_entry"],[985,"acl_entry2key0"],[1024,"acl_entry_abstract2key"],[1029,"acl_entry2key"],[1037,"acl_entry_no_log2key"],[1052,"fix_transfer_groups"],[1080,"equalize_acl_groups"],[1129,"subst_ace_name_og"],[1157,"check_max_acl_entries"],[1188,"equalize_acl_entries"],[1354,"__ANON__"],[1422,"equalize_acl"]],"start":{"531":{"merge_acls":[{"time":null,"subroutine":15,"branch":38,"condition":10,"statement":173}]},"32":{"BEGIN":[{"condition":null,"statement":3,"time":null,"subroutine":1,"branch":null}]},"593":{"enter_conf_mode":[{"condition":11,"statement":204,"branch":44,"time":null,"subroutine":16}]},"232":{"analyze_conf_lines":[{"statement":22,"condition":null,"branch":null,"subroutine":8,"time":null}]},"1037":{"acl_entry_no_log2key":[{"time":null,"subroutine":33,"branch":97,"condition":29,"statement":423}]},"35":{"BEGIN":[{"branch":null,"time":null,"subroutine":4,"condition":null,"statement":12}]},"941":{"check_object_group":[{"branch":83,"time":null,"subroutine":27,"condition":21,"statement":376}]},"1129":{"subst_ace_name_og":[{"condition":32,"statement":468,"time":null,"subroutine":36,"branch":108}]},"985":{"acl_entry2key0":[{"condition":24,"statement":395,"branch":88,"time":null,"subroutine":30}]},"1354":{"__ANON__":[{"condition":39,"statement":578,"branch":127,"time":null,"subroutine":39}]},"1080":{"equalize_acl_groups":[{"branch":104,"time":null,"subroutine":35,"condition":30,"statement":442}]},"468":{"parse_port_spec":[{"branch":28,"subroutine":12,"time":null,"statement":140,"condition":8}]},"-1":{"__COVER__":[{"subroutine":41,"time":null,"branch":127,"statement":580,"condition":40}]},"820":{"sort_object_group":[{"condition":20,"statement":311,"time":null,"subroutine":25,"branch":72}]},"170":{"tcp_name2num":[{"branch":null,"subroutine":6,"time":null,"statement":18,"condition":null}]},"1188":{"equalize_acl_entries":[{"condition":35,"statement":484,"branch":111,"time":null,"subroutine":38}]},"31":{"BEGIN":[{"branch":null,"subroutine":null,"time":null,"statement":null,"condition":null}]},"520":{"normalize_proto":[{"branch":36,"time":null,"subroutine":14,"condition":9,"statement":168}]},"1052":{"fix_transfer_groups":[{"condition":29,"statement":425,"time":null,"subroutine":34,"branch":97}]},"968":{"mark_object_group_from_acl_entry":[{"time":null,"subroutine":29,"branch":85,"condition":23,"statement":387}]},"436":{"parse_port":[{"condition":6,"statement":127,"time":null,"subroutine":11,"branch":23}]},"634":{"login_enable":[{"condition":11,"statement":222,"branch":44,"time":null,"subroutine":23}]},"742":{"checkinterfaces":[{"subroutine":24,"time":null,"branch":60,"statement":283,"condition":16}]},"625":{"get_identity":[{"subroutine":22,"time":null,"branch":44,"statement":218,"condition":11}]},"615":{"route_add":[{"branch":44,"time":null,"subroutine":20,"condition":11,"statement":214}]},"216":{"udp_name2num":[{"statement":20,"condition":null,"subroutine":7,"time":null,"branch":null}]},"961":{"mark_object_group_from_acl":[{"statement":383,"condition":23,"subroutine":28,"time":null,"branch":85}]},"605":{"check_conf_mode":[{"branch":44,"subroutine":18,"time":null,"statement":210,"condition":11}]},"1422":{"equalize_acl":[{"condition":39,"statement":578,"branch":127,"time":null,"subroutine":40}]},"413":{"parse_address":[{"branch":21,"time":null,"subroutine":9,"condition":5,"statement":115}]},"1029":{"acl_entry2key":[{"time":null,"subroutine":32,"branch":97,"condition":29,"statement":421}]},"505":{"parse_icmp_spec":[{"subroutine":13,"time":null,"branch":34,"statement":158,"condition":8}]},"431":{"adjust_mask":[{"subroutine":10,"time":null,"branch":23,"statement":125,"condition":6}]},"1157":{"check_max_acl_entries":[{"subroutine":37,"time":null,"branch":110,"statement":479,"condition":34}]},"36":{"BEGIN":[{"condition":null,"statement":15,"branch":null,"time":null,"subroutine":5}]},"620":{"route_del":[{"subroutine":21,"time":null,"branch":44,"statement":216,"condition":11}]},"1024":{"acl_entry_abstract2key":[{"branch":97,"time":null,"subroutine":31,"condition":29,"statement":419}]},"599":{"leave_conf_mode":[{"condition":11,"statement":207,"branch":44,"time":null,"subroutine":17}]},"34":{"BEGIN":[{"branch":null,"time":null,"subroutine":3,"condition":null,"statement":9}]},"834":{"equalize_obj_group":[{"condition":20,"statement":319,"branch":72,"time":null,"subroutine":26}]},"610":{"write_mem":[{"time":null,"subroutine":19,"branch":44,"condition":11,"statement":212}]},"33":{"BEGIN":[{"branch":null,"subroutine":2,"time":null,"statement":6,"condition":null}]}},"branch":[[246,{"text":"if ($line =~ /$end_banner_regex/) { }"}],[245,{"text":"if (my $cmd = $in_banner)"}],[256,{"text":"if $line =~ /^ *!/"}],[259,{"text":"if $line =~ /^\\s*$/"}],[279,{"text":"unless ($parse_info and keys %$parse_info)"}],[274,{"text":"if ($first_subcmd) { }"}],[299,{"text":"if ($level + 1 == $sub_level and $rest eq 'quit') { }"}],[298,{"text":"if ($sub_level != $level)"}],[265,{"text":"if ($sub_level == $level) { }"}],[265,{"text":"elsif ($sub_level > $level) { }"}],[328,{"text":"if ($next = $prefix_info->{$prefix}) { }"}],[328,{"text":"elsif ($next = $prefix_info->{'_any'}) { }"}],[328,{"text":"elsif ($next = $prefix_info->{'_skip'}) { }"}],[349,{"text":"unless keys %$next"}],[319,{"text":"if (my $prefix_info = $parse_info->{'_prefix'})"}],[356,{"text":"unless ($lookup)"}],[371,{"text":"if (my $subcmd = $cmd_info->{'subcmd'}) { }"}],[371,{"text":"elsif ($end_banner_regex = $cmd_info->{'banner'}) { }"}],[397,{"text":"if $strict eq 'err'"}],[395,{"text":"if ($strict)"}],[359,{"text":"if (my $cmd_info = $parse_info->{$lookup} || $parse_info->{'_any'}) { }"}],[416,{"text":"if ($token eq 'any' or $token eq 'any4') { }"}],[416,{"text":"elsif ($token eq 'host') { }"}],[440,{"text":"if $port =~ /^\\d+$/"}],[454,{"text":"if ($tcp and $udp and $tcp == $udp) { }"}],[443,{"text":"if ($proto eq 'tcp') { }"}],[443,{"text":"elsif ($proto eq 'udp') { }"}],[461,{"text":"unless defined $port"}],[470,{"text":"unless my $spec = check_regex('eq|gt|lt|neq|range', $arg)"}],[473,{"text":"if ($spec eq 'eq') { }"}],[473,{"text":"elsif ($spec eq 'gt') { }"}],[473,{"text":"elsif ($spec eq 'lt') { }"}],[473,{"text":"elsif ($spec eq 'neq') { }"}],[473,{"text":"elsif ($spec eq 'range') { }"}],[508,{"text":"unless defined $token"}],[509,{"text":"if (my $spec = $ICMP_Names{$token}) { }"}],[522,{"text":"unless $proto =~ /^(?:\\d+|icmp|tcp|udp)$/"}],[524,{"text":"if $proto =~ /^(1|6|17)$/"}],[537,{"text":"unless ($spoc_intf)"}],[562,{"text":"if ($$spoc_entries[$index - 1]{'MODE'} eq 'deny') { }"}],[556,{"text":"if ($append) { }"}],[581,{"text":"if $spoc->{'ACCESS_LIST'}{$raw_name}"}],[549,{"text":"if (my $spoc_name = $spoc_intf->{$access_group}) { }"}],[546,{"text":"if (my $raw_name = $raw_intf->{$access_group})"}],[644,{"text":"unless ($pass)"}],[656,{"text":"unless $con->{'EXPECT'}->spawn('ssh', '-l', $user, $ip)"}],[661,{"text":"if ($try_telnet = $self->{'CONFIG'}{'try_telnet'}) { }"}],[674,{"text":"if ($match =~ m[\\(yes/no\\)\\?]i)"}],[660,{"text":"if ($result->{'ERROR'}) { }"}],[654,{"text":"if ($user)"}],[689,{"text":"unless $con->{'EXPECT'}->spawn('telnet', $ip)"}],[693,{"text":"if ($result->{'ERROR'})"}],[698,{"text":"unless ($user)"}],[697,{"text":"if ($con->{'RESULT'}{'MATCH'} =~ qr/username:/i)"}],[705,{"text":"if ($con->{'RESULT'}{'MATCH'} =~ qr/password:/i)"}],[687,{"text":"if (not $user or $try_telnet)"}],[717,{"text":"if ($con->{'RESULT'}{'MATCH'} ne '#')"}],[723,{"text":"if ($con->{'RESULT'}{'MATCH'} ne '#')"}],[712,{"text":"if ($match eq '>') { }"}],[712,{"text":"elsif ($match ne '#') { }"}],[747,{"text":"unless (keys %{$$spoc{'IF'};})"}],[754,{"text":"if $conf_intf->{'SHUTDOWN'}"}],[755,{"text":"unless $conf_intf->{'ADDRESS'} or $conf_intf->{'UNNUMBERED'}"}],[761,{"text":"unless $conf_vrf eq $spoc_vrf"}],[767,{"text":"$conf_intf->{'INSPECT'} ? :"}],[768,{"text":"$spoc_intf->{'INSPECT'} ? :"}],[769,{"text":"unless $conf_inspect eq $spoc_inspect"}],[756,{"text":"if (my $spoc_intf = $spoc->{'IF'}{$name}) { }"}],[779,{"text":"if $conf->{'IF'}{$name}"}],[784,{"text":"if ($intf->{'UNNUMBERED'})"}],[782,{"text":"if ($has_mpls and $name =~ /^mpls/)"}],[792,{"text":"if @errors"}],[844,{"text":"if ($conf_group->{'name'} ne $other_conf_group_name) { }"}],[842,{"text":"if (my $other_conf_group_name = $spoc_group->{'name_on_dev'})"}],[859,{"text":"if (my $other_spoc_group = $conf_group->{'needed'})"}],[867,{"text":"if ($spoc_group->{'transfer'} and $spoc_group->{'fixed'})"}],[872,{"text":"if ($conf_group->{'TYPE'} ne $spoc_group->{'TYPE'})"}],[893,{"text":"if ($diff->Diff)"}],[904,{"text":"if ($spoc_group->{'transfer'})"}],[900,{"text":"if (not $change_lines) { }"}],[900,{"text":"elsif ($change_lines >= @$spoc_networks) { }"}],[926,{"text":"if $diff->Same"}],[932,{"text":"if ($spoc_group->{'transfer'})"}],[943,{"text":"if ($abstract) { }"}],[942,{"text":"if (ref $attr and my $group = $attr->{'GROUP'}) { }"}],[969,{"text":"if $acl_entry->{'REMARK'}"}],[973,{"text":"unless ($group->{'name_on_dev'})"}],[972,{"text":"if (my $group = ref $what && $what->{'GROUP'})"}],[987,{"text":"if (my $string = $e->{'REMARK'})"}],[1004,{"text":"defined $v ? :"}],[1012,{"text":"if $e->{'ESTA'}"}],[1000,{"text":"if ($e->{'TYPE'} eq 'icmp') { }"}],[1000,{"text":"elsif ($e->{'TYPE'} eq 'tcp' or $e->{'TYPE'} eq 'udp') { }"}],[1016,{"text":"if $e->{'LOG_MODE'}"}],[1017,{"text":"if $e->{'LOG_LEVEL'}"}],[1018,{"text":"if $e->{'LOG_INTERVAL'}"}],[1014,{"text":"if (my $log = $e->{'LOG'} && !$ignore_log)"}],[1053,{"text":"unless keys %$dupl"}],[1054,{"text":"if $entry->{'REMARK'}"}],[1059,{"text":"if ($group->{'transfer'})"}],[1058,{"text":"if (ref $what and my $group = $what->{'GROUP'})"}],[1064,{"text":"unless @need_fix"}],[1066,{"text":"unless (keys %$abstract)"}],[1070,{"text":"unless $abstract->{$key}"}],[1095,{"text":"if $conf_entry->{'REMARK'}"}],[1102,{"text":"if ($self->equalize_obj_group($conf_group, $spoc_group)) { }"}],[1099,{"text":"if (my $conf_group = ref $what && $what->{'GROUP'})"}],[1089,{"text":"if ($diff->Same) { }"}],[1140,{"text":"unless my $new_gid = $group->{'name_on_dev'} || $group->{'transfer'} && $group->{'new_name'}"}],[1137,{"text":"if (my $group = ref $what && $what->{'GROUP'})"}],[1160,{"text":"if ($incr > 1 and @$entries >= $incr)"}],[1246,{"text":"if $dupl{$key}"}],[1244,{"text":"unless ($conf_entry->{'REMARK'})"}],[1241,{"text":"if ($diff->Diff & 1)"}],[1272,{"text":"if not $add_incr and $prev_entry"}],[1290,{"text":"if ($self->is_device_access($conf_entry))"}],[1301,{"text":"if ($device_line{$next_conf_entry} < $device_line{$conf_entry}) { }"}],[1285,{"text":"if (not $spoc_entry->{'REMARK'} and my $conf_entry = $dupl{$key}) { }"}],[1258,{"text":"if ($diff->Diff & 2)"}],[1342,{"text":"unless @add or @delete"}],[1358,{"text":"if ($line = $device_line{$next_entry})"}],[1370,{"text":"if (my $conf_entry = $move_up{$spoc_entry})"}],[1381,{"text":"$vcmd1 ? :"}],[1389,{"text":"if $moved{$conf_entry}"}],[1395,{"text":"if (my $spoc_entry = $move_down{$conf_entry})"}],[1402,{"text":"$vcmd2 ? :"}],[1405,{"text":"if (@vcmds) { }"}]]}